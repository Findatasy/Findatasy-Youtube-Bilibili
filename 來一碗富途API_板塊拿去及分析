{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2020-10-24 18:07:51,301 [open_context_base.py] _socket_reconnect_and_wait_ready:255: Start connecting: host=127.0.0.1; port=11111;\n",
      "2020-10-24 18:07:51,304 [open_context_base.py] on_connected:344: Connected : conn_id=1; \n",
      "2020-10-24 18:07:51,308 [open_context_base.py] _handle_init_connect:445: InitConnect ok: conn_id=1; info={'server_version': 217, 'login_user_id': 7182561, 'conn_id': 6725709369406767066, 'conn_key': '31DBDE2FD7917860', 'conn_iv': 'AADBEE30CF2F38EC', 'keep_alive_interval': 10, 'is_encrypt': False};\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "         code plate_name plate_id\n",
      "0   HK.BK1000      做空集合股   BK1000\n",
      "1   HK.BK1110      阿里概念股   BK1110\n",
      "2   HK.BK1161        双十一   BK1161\n",
      "3   HK.BK1165      雄安概念股   BK1165\n",
      "4   HK.BK1166       苹果概念   BK1166\n",
      "..        ...        ...      ...\n",
      "87  HK.BK1994      香港零售股   BK1994\n",
      "88  HK.BK1995        区块链   BK1995\n",
      "89  HK.BK1996       猪肉概念   BK1996\n",
      "90  HK.BK1998      节假日概念   BK1998\n",
      "91  HK.BK1999       殡葬概念   BK1999\n",
      "\n",
      "[92 rows x 3 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2020-10-24 18:07:51,364 [network_manager.py] work:366: Close: conn_id=1\n"
     ]
    }
   ],
   "source": [
    "from futu import * #導入富途API模塊\n",
    "import pandas as pd #導入Pandas模塊\n",
    "quote_ctx = OpenQuoteContext(host='127.0.0.1', port=11111)\n",
    "ret, data = quote_ctx.get_plate_list(Market.HK, Plate.CONCEPT) #拿取所有香港概念板塊\n",
    "if ret == RET_OK:\n",
    "    print(data)\n",
    "else:\n",
    "    print('error:', data)\n",
    "quote_ctx.close() # 結束後記得關閉當條連接，防止連接條數用盡"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_plate_list = [] #設置一個只有板塊代碼的variable\n",
    "for i in data.code:\n",
    "    data_plate_list.append(i)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['HK.BK1000',\n",
       " 'HK.BK1110',\n",
       " 'HK.BK1161',\n",
       " 'HK.BK1165',\n",
       " 'HK.BK1166',\n",
       " 'HK.BK1175',\n",
       " 'HK.BK1176',\n",
       " 'HK.BK1178',\n",
       " 'HK.BK1180',\n",
       " 'HK.BK1181',\n",
       " 'HK.BK1183',\n",
       " 'HK.BK1185',\n",
       " 'HK.BK1186',\n",
       " 'HK.BK1187',\n",
       " 'HK.BK1188',\n",
       " 'HK.BK1190',\n",
       " 'HK.BK1191',\n",
       " 'HK.BK1192',\n",
       " 'HK.BK1193',\n",
       " 'HK.BK1196',\n",
       " 'HK.BK1197',\n",
       " 'HK.BK1198',\n",
       " 'HK.BK1199',\n",
       " 'HK.BK1200',\n",
       " 'HK.BK1201',\n",
       " 'HK.BK1202',\n",
       " 'HK.BK1203',\n",
       " 'HK.BK1204',\n",
       " 'HK.BK1205',\n",
       " 'HK.BK1206',\n",
       " 'HK.BK1207',\n",
       " 'HK.BK1208',\n",
       " 'HK.BK1209',\n",
       " 'HK.BK1210',\n",
       " 'HK.BK1212',\n",
       " 'HK.BK1213',\n",
       " 'HK.BK1214',\n",
       " 'HK.BK1215',\n",
       " 'HK.BK1216',\n",
       " 'HK.BK1217',\n",
       " 'HK.BK1218',\n",
       " 'HK.BK1219',\n",
       " 'HK.BK1220',\n",
       " 'HK.BK1221',\n",
       " 'HK.BK1222',\n",
       " 'HK.BK1223',\n",
       " 'HK.BK1224',\n",
       " 'HK.BK1225',\n",
       " 'HK.BK1226',\n",
       " 'HK.BK1227',\n",
       " 'HK.BK1228',\n",
       " 'HK.BK1230',\n",
       " 'HK.BK1231',\n",
       " 'HK.BK1232',\n",
       " 'HK.BK1233',\n",
       " 'HK.BK1234',\n",
       " 'HK.BK1235',\n",
       " 'HK.BK1236',\n",
       " 'HK.BK1237',\n",
       " 'HK.BK1238',\n",
       " 'HK.BK1239',\n",
       " 'HK.BK1240',\n",
       " 'HK.BK1241',\n",
       " 'HK.BK1242',\n",
       " 'HK.BK1243',\n",
       " 'HK.BK1244',\n",
       " 'HK.BK1245',\n",
       " 'HK.BK1246',\n",
       " 'HK.BK1247',\n",
       " 'HK.BK1249',\n",
       " 'HK.BK1250',\n",
       " 'HK.BK1251',\n",
       " 'HK.BK1252',\n",
       " 'HK.BK1253',\n",
       " 'HK.BK1254',\n",
       " 'HK.BK1255',\n",
       " 'HK.BK1261',\n",
       " 'HK.BK1263',\n",
       " 'HK.BK1264',\n",
       " 'HK.BK1266',\n",
       " 'HK.BK1267',\n",
       " 'HK.BK1279',\n",
       " 'HK.BK1281',\n",
       " 'HK.BK1285',\n",
       " 'HK.BK1991',\n",
       " 'HK.BK1992',\n",
       " 'HK.BK1993',\n",
       " 'HK.BK1994',\n",
       " 'HK.BK1995',\n",
       " 'HK.BK1996',\n",
       " 'HK.BK1998',\n",
       " 'HK.BK1999']"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_plate_list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2020-10-24 18:09:17,881 [open_context_base.py] _socket_reconnect_and_wait_ready:255: Start connecting: host=127.0.0.1; port=11111;\n",
      "2020-10-24 18:09:17,883 [open_context_base.py] on_connected:344: Connected : conn_id=2; \n",
      "2020-10-24 18:09:17,886 [open_context_base.py] _handle_init_connect:445: InitConnect ok: conn_id=2; info={'server_version': 217, 'login_user_id': 7182561, 'conn_id': 6725709732549436854, 'conn_key': '34F76230D791C056', 'conn_iv': '2459BE74DC2FD807', 'keep_alive_interval': 10, 'is_encrypt': False};\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "         code          update_time  last_price  open_price  high_price  \\\n",
      "0   HK.BK1000  2020-10-23 16:00:00    1121.395    1133.182    1136.098   \n",
      "1   HK.BK1110  2020-10-23 15:59:57    1806.139    1834.111    1838.084   \n",
      "2   HK.BK1161  2020-10-23 16:00:00   12677.146   12648.664   12743.714   \n",
      "3   HK.BK1165  2020-10-23 16:00:00     776.809     788.918     788.918   \n",
      "4   HK.BK1166  2020-10-23 16:00:00    2532.142    2580.487    2589.357   \n",
      "..        ...                  ...         ...         ...         ...   \n",
      "87  HK.BK1994  2020-10-23 16:00:00     926.096     934.429     934.843   \n",
      "88  HK.BK1995  2020-10-23 16:00:00    1126.042    1121.800    1130.633   \n",
      "89  HK.BK1996  2020-10-23 16:00:00     756.105     765.089     772.667   \n",
      "90  HK.BK1998  2020-10-23 16:00:00    2141.733    2169.699    2179.485   \n",
      "91  HK.BK1999  2020-10-23 15:58:51    1164.817    1169.984    1176.863   \n",
      "\n",
      "    low_price  prev_close_price     volume      turnover  turnover_rate  ...  \\\n",
      "0    1118.934          1133.993  216671621  2.586155e+09          0.124  ...   \n",
      "1    1786.672          1835.805   63055488  3.139808e+08          0.128  ...   \n",
      "2   12607.925         12742.681   53985118  5.047610e+09          0.106  ...   \n",
      "3     772.729           789.990   50223996  3.117642e+08          0.128  ...   \n",
      "4    2506.867          2566.059   60505677  1.247391e+09          0.275  ...   \n",
      "..        ...               ...        ...           ...            ...  ...   \n",
      "87    922.116           931.554   60911461  1.029380e+08          0.266  ...   \n",
      "88   1118.884          1129.235  162842093  6.734258e+09          0.119  ...   \n",
      "89    754.769           761.073   58222412  2.672548e+08          0.251  ...   \n",
      "90   2127.227          2175.878   44408303  3.993878e+09          0.084  ...   \n",
      "91   1154.451          1157.602    4255665  2.152166e+07          0.057  ...   \n",
      "\n",
      "    pre_turnover pre_change_val  pre_change_rate  pre_amplitude  after_price  \\\n",
      "0            N/A            N/A              N/A            N/A          N/A   \n",
      "1            N/A            N/A              N/A            N/A          N/A   \n",
      "2            N/A            N/A              N/A            N/A          N/A   \n",
      "3            N/A            N/A              N/A            N/A          N/A   \n",
      "4            N/A            N/A              N/A            N/A          N/A   \n",
      "..           ...            ...              ...            ...          ...   \n",
      "87           N/A            N/A              N/A            N/A          N/A   \n",
      "88           N/A            N/A              N/A            N/A          N/A   \n",
      "89           N/A            N/A              N/A            N/A          N/A   \n",
      "90           N/A            N/A              N/A            N/A          N/A   \n",
      "91           N/A            N/A              N/A            N/A          N/A   \n",
      "\n",
      "    after_high_price  after_low_price  after_change_val  after_change_rate  \\\n",
      "0                N/A              N/A               N/A                N/A   \n",
      "1                N/A              N/A               N/A                N/A   \n",
      "2                N/A              N/A               N/A                N/A   \n",
      "3                N/A              N/A               N/A                N/A   \n",
      "4                N/A              N/A               N/A                N/A   \n",
      "..               ...              ...               ...                ...   \n",
      "87               N/A              N/A               N/A                N/A   \n",
      "88               N/A              N/A               N/A                N/A   \n",
      "89               N/A              N/A               N/A                N/A   \n",
      "90               N/A              N/A               N/A                N/A   \n",
      "91               N/A              N/A               N/A                N/A   \n",
      "\n",
      "    after_amplitude  \n",
      "0               N/A  \n",
      "1               N/A  \n",
      "2               N/A  \n",
      "3               N/A  \n",
      "4               N/A  \n",
      "..              ...  \n",
      "87              N/A  \n",
      "88              N/A  \n",
      "89              N/A  \n",
      "90              N/A  \n",
      "91              N/A  \n",
      "\n",
      "[92 rows x 132 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2020-10-24 18:09:18,065 [network_manager.py] work:366: Close: conn_id=2\n"
     ]
    }
   ],
   "source": [
    "quote_ctx = OpenQuoteContext(host='127.0.0.1', port=11111)\n",
    "ret, data_plate = quote_ctx.get_market_snapshot(data_plate_list) #拿取每個板塊當日的表現\n",
    "if ret == RET_OK:\n",
    "    print(data_plate)\n",
    "\n",
    "else:\n",
    "    print('error:', data_plate)\n",
    "quote_ctx.close() # 結束後記得關閉當條連接，防止連接條數用盡"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_plate = data_plate.merge(data, on='code') #把香港板塊的名字加入返每個板塊當日的表現的表"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_plate.set_index('plate_name', inplace=True) #把香港板塊的名字變成索引"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_plate['price_change'] = (data_plate['last_price'] / data_plate['prev_close_price']) - 1 #計算每個板塊的當日價格變動"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code</th>\n",
       "      <th>update_time</th>\n",
       "      <th>last_price</th>\n",
       "      <th>open_price</th>\n",
       "      <th>high_price</th>\n",
       "      <th>low_price</th>\n",
       "      <th>prev_close_price</th>\n",
       "      <th>volume</th>\n",
       "      <th>turnover</th>\n",
       "      <th>turnover_rate</th>\n",
       "      <th>...</th>\n",
       "      <th>pre_change_rate</th>\n",
       "      <th>pre_amplitude</th>\n",
       "      <th>after_price</th>\n",
       "      <th>after_high_price</th>\n",
       "      <th>after_low_price</th>\n",
       "      <th>after_change_val</th>\n",
       "      <th>after_change_rate</th>\n",
       "      <th>after_amplitude</th>\n",
       "      <th>plate_id</th>\n",
       "      <th>price_change</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>plate_name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>做空集合股</th>\n",
       "      <td>HK.BK1000</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>1121.395</td>\n",
       "      <td>1133.182</td>\n",
       "      <td>1136.098</td>\n",
       "      <td>1118.934</td>\n",
       "      <td>1133.993</td>\n",
       "      <td>216671621</td>\n",
       "      <td>2.586155e+09</td>\n",
       "      <td>0.124</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1000</td>\n",
       "      <td>-0.011109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>阿里概念股</th>\n",
       "      <td>HK.BK1110</td>\n",
       "      <td>2020-10-23 15:59:57</td>\n",
       "      <td>1806.139</td>\n",
       "      <td>1834.111</td>\n",
       "      <td>1838.084</td>\n",
       "      <td>1786.672</td>\n",
       "      <td>1835.805</td>\n",
       "      <td>63055488</td>\n",
       "      <td>3.139808e+08</td>\n",
       "      <td>0.128</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1110</td>\n",
       "      <td>-0.016160</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>双十一</th>\n",
       "      <td>HK.BK1161</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>12677.146</td>\n",
       "      <td>12648.664</td>\n",
       "      <td>12743.714</td>\n",
       "      <td>12607.925</td>\n",
       "      <td>12742.681</td>\n",
       "      <td>53985118</td>\n",
       "      <td>5.047610e+09</td>\n",
       "      <td>0.106</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1161</td>\n",
       "      <td>-0.005143</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>雄安概念股</th>\n",
       "      <td>HK.BK1165</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>776.809</td>\n",
       "      <td>788.918</td>\n",
       "      <td>788.918</td>\n",
       "      <td>772.729</td>\n",
       "      <td>789.990</td>\n",
       "      <td>50223996</td>\n",
       "      <td>3.117642e+08</td>\n",
       "      <td>0.128</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1165</td>\n",
       "      <td>-0.016685</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>苹果概念</th>\n",
       "      <td>HK.BK1166</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>2532.142</td>\n",
       "      <td>2580.487</td>\n",
       "      <td>2589.357</td>\n",
       "      <td>2506.867</td>\n",
       "      <td>2566.059</td>\n",
       "      <td>60505677</td>\n",
       "      <td>1.247391e+09</td>\n",
       "      <td>0.275</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1166</td>\n",
       "      <td>-0.013218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>香港零售股</th>\n",
       "      <td>HK.BK1994</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>926.096</td>\n",
       "      <td>934.429</td>\n",
       "      <td>934.843</td>\n",
       "      <td>922.116</td>\n",
       "      <td>931.554</td>\n",
       "      <td>60911461</td>\n",
       "      <td>1.029380e+08</td>\n",
       "      <td>0.266</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1994</td>\n",
       "      <td>-0.005859</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>区块链</th>\n",
       "      <td>HK.BK1995</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>1126.042</td>\n",
       "      <td>1121.800</td>\n",
       "      <td>1130.633</td>\n",
       "      <td>1118.884</td>\n",
       "      <td>1129.235</td>\n",
       "      <td>162842093</td>\n",
       "      <td>6.734258e+09</td>\n",
       "      <td>0.119</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1995</td>\n",
       "      <td>-0.002828</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>猪肉概念</th>\n",
       "      <td>HK.BK1996</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>756.105</td>\n",
       "      <td>765.089</td>\n",
       "      <td>772.667</td>\n",
       "      <td>754.769</td>\n",
       "      <td>761.073</td>\n",
       "      <td>58222412</td>\n",
       "      <td>2.672548e+08</td>\n",
       "      <td>0.251</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1996</td>\n",
       "      <td>-0.006528</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>节假日概念</th>\n",
       "      <td>HK.BK1998</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>2141.733</td>\n",
       "      <td>2169.699</td>\n",
       "      <td>2179.485</td>\n",
       "      <td>2127.227</td>\n",
       "      <td>2175.878</td>\n",
       "      <td>44408303</td>\n",
       "      <td>3.993878e+09</td>\n",
       "      <td>0.084</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1998</td>\n",
       "      <td>-0.015693</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>殡葬概念</th>\n",
       "      <td>HK.BK1999</td>\n",
       "      <td>2020-10-23 15:58:51</td>\n",
       "      <td>1164.817</td>\n",
       "      <td>1169.984</td>\n",
       "      <td>1176.863</td>\n",
       "      <td>1154.451</td>\n",
       "      <td>1157.602</td>\n",
       "      <td>4255665</td>\n",
       "      <td>2.152166e+07</td>\n",
       "      <td>0.057</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1999</td>\n",
       "      <td>0.006233</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>92 rows × 134 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 code          update_time  last_price  open_price  \\\n",
       "plate_name                                                           \n",
       "做空集合股       HK.BK1000  2020-10-23 16:00:00    1121.395    1133.182   \n",
       "阿里概念股       HK.BK1110  2020-10-23 15:59:57    1806.139    1834.111   \n",
       "双十一         HK.BK1161  2020-10-23 16:00:00   12677.146   12648.664   \n",
       "雄安概念股       HK.BK1165  2020-10-23 16:00:00     776.809     788.918   \n",
       "苹果概念        HK.BK1166  2020-10-23 16:00:00    2532.142    2580.487   \n",
       "...               ...                  ...         ...         ...   \n",
       "香港零售股       HK.BK1994  2020-10-23 16:00:00     926.096     934.429   \n",
       "区块链         HK.BK1995  2020-10-23 16:00:00    1126.042    1121.800   \n",
       "猪肉概念        HK.BK1996  2020-10-23 16:00:00     756.105     765.089   \n",
       "节假日概念       HK.BK1998  2020-10-23 16:00:00    2141.733    2169.699   \n",
       "殡葬概念        HK.BK1999  2020-10-23 15:58:51    1164.817    1169.984   \n",
       "\n",
       "            high_price  low_price  prev_close_price     volume      turnover  \\\n",
       "plate_name                                                                     \n",
       "做空集合股         1136.098   1118.934          1133.993  216671621  2.586155e+09   \n",
       "阿里概念股         1838.084   1786.672          1835.805   63055488  3.139808e+08   \n",
       "双十一          12743.714  12607.925         12742.681   53985118  5.047610e+09   \n",
       "雄安概念股          788.918    772.729           789.990   50223996  3.117642e+08   \n",
       "苹果概念          2589.357   2506.867          2566.059   60505677  1.247391e+09   \n",
       "...                ...        ...               ...        ...           ...   \n",
       "香港零售股          934.843    922.116           931.554   60911461  1.029380e+08   \n",
       "区块链           1130.633   1118.884          1129.235  162842093  6.734258e+09   \n",
       "猪肉概念           772.667    754.769           761.073   58222412  2.672548e+08   \n",
       "节假日概念         2179.485   2127.227          2175.878   44408303  3.993878e+09   \n",
       "殡葬概念          1176.863   1154.451          1157.602    4255665  2.152166e+07   \n",
       "\n",
       "            turnover_rate  ...  pre_change_rate pre_amplitude  after_price  \\\n",
       "plate_name                 ...                                               \n",
       "做空集合股               0.124  ...              N/A           N/A          N/A   \n",
       "阿里概念股               0.128  ...              N/A           N/A          N/A   \n",
       "双十一                 0.106  ...              N/A           N/A          N/A   \n",
       "雄安概念股               0.128  ...              N/A           N/A          N/A   \n",
       "苹果概念                0.275  ...              N/A           N/A          N/A   \n",
       "...                   ...  ...              ...           ...          ...   \n",
       "香港零售股               0.266  ...              N/A           N/A          N/A   \n",
       "区块链                 0.119  ...              N/A           N/A          N/A   \n",
       "猪肉概念                0.251  ...              N/A           N/A          N/A   \n",
       "节假日概念               0.084  ...              N/A           N/A          N/A   \n",
       "殡葬概念                0.057  ...              N/A           N/A          N/A   \n",
       "\n",
       "            after_high_price  after_low_price  after_change_val  \\\n",
       "plate_name                                                        \n",
       "做空集合股                    N/A              N/A               N/A   \n",
       "阿里概念股                    N/A              N/A               N/A   \n",
       "双十一                      N/A              N/A               N/A   \n",
       "雄安概念股                    N/A              N/A               N/A   \n",
       "苹果概念                     N/A              N/A               N/A   \n",
       "...                      ...              ...               ...   \n",
       "香港零售股                    N/A              N/A               N/A   \n",
       "区块链                      N/A              N/A               N/A   \n",
       "猪肉概念                     N/A              N/A               N/A   \n",
       "节假日概念                    N/A              N/A               N/A   \n",
       "殡葬概念                     N/A              N/A               N/A   \n",
       "\n",
       "            after_change_rate  after_amplitude  plate_id  price_change  \n",
       "plate_name                                                              \n",
       "做空集合股                     N/A              N/A    BK1000     -0.011109  \n",
       "阿里概念股                     N/A              N/A    BK1110     -0.016160  \n",
       "双十一                       N/A              N/A    BK1161     -0.005143  \n",
       "雄安概念股                     N/A              N/A    BK1165     -0.016685  \n",
       "苹果概念                      N/A              N/A    BK1166     -0.013218  \n",
       "...                       ...              ...       ...           ...  \n",
       "香港零售股                     N/A              N/A    BK1994     -0.005859  \n",
       "区块链                       N/A              N/A    BK1995     -0.002828  \n",
       "猪肉概念                      N/A              N/A    BK1996     -0.006528  \n",
       "节假日概念                     N/A              N/A    BK1998     -0.015693  \n",
       "殡葬概念                      N/A              N/A    BK1999      0.006233  \n",
       "\n",
       "[92 rows x 134 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_plate"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_plate = data_plate.sort_values(by='price_change', ascending=False)[:20] #富途交易程式有相關功能 #拿取頭20表現最好的板塊\n",
    "data_plate_top_20 = data_plate.code.to_list()[:20] #設置一個頭20表現最好的板塊的variable"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['HK.BK1241',\n",
       " 'HK.BK1205',\n",
       " 'HK.BK1186',\n",
       " 'HK.BK1224',\n",
       " 'HK.BK1244',\n",
       " 'HK.BK1252',\n",
       " 'HK.BK1237',\n",
       " 'HK.BK1240',\n",
       " 'HK.BK1213',\n",
       " 'HK.BK1196',\n",
       " 'HK.BK1228',\n",
       " 'HK.BK1225',\n",
       " 'HK.BK1210',\n",
       " 'HK.BK1992',\n",
       " 'HK.BK1200',\n",
       " 'HK.BK1187',\n",
       " 'HK.BK1209',\n",
       " 'HK.BK1233',\n",
       " 'HK.BK1267',\n",
       " 'HK.BK1214']"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_plate_top_20"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code</th>\n",
       "      <th>update_time</th>\n",
       "      <th>last_price</th>\n",
       "      <th>open_price</th>\n",
       "      <th>high_price</th>\n",
       "      <th>low_price</th>\n",
       "      <th>prev_close_price</th>\n",
       "      <th>volume</th>\n",
       "      <th>turnover</th>\n",
       "      <th>turnover_rate</th>\n",
       "      <th>...</th>\n",
       "      <th>pre_change_rate</th>\n",
       "      <th>pre_amplitude</th>\n",
       "      <th>after_price</th>\n",
       "      <th>after_high_price</th>\n",
       "      <th>after_low_price</th>\n",
       "      <th>after_change_val</th>\n",
       "      <th>after_change_rate</th>\n",
       "      <th>after_amplitude</th>\n",
       "      <th>plate_id</th>\n",
       "      <th>price_change</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>plate_name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>石化股</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>537.201</td>\n",
       "      <td>502.693</td>\n",
       "      <td>537.201</td>\n",
       "      <td>499.443</td>\n",
       "      <td>497.907</td>\n",
       "      <td>272837327</td>\n",
       "      <td>7.676172e+08</td>\n",
       "      <td>0.159</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1241</td>\n",
       "      <td>0.078918</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>石油股</th>\n",
       "      <td>HK.BK1205</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>536.771</td>\n",
       "      <td>506.566</td>\n",
       "      <td>537.811</td>\n",
       "      <td>503.674</td>\n",
       "      <td>502.647</td>\n",
       "      <td>678404412</td>\n",
       "      <td>2.550321e+09</td>\n",
       "      <td>0.181</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1205</td>\n",
       "      <td>0.067889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>稀土概念</th>\n",
       "      <td>HK.BK1186</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>994.945</td>\n",
       "      <td>962.804</td>\n",
       "      <td>1017.220</td>\n",
       "      <td>962.804</td>\n",
       "      <td>953.847</td>\n",
       "      <td>58541545</td>\n",
       "      <td>4.082278e+08</td>\n",
       "      <td>0.171</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1186</td>\n",
       "      <td>0.043087</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>电力设备股</th>\n",
       "      <td>HK.BK1224</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>703.144</td>\n",
       "      <td>682.908</td>\n",
       "      <td>717.979</td>\n",
       "      <td>682.908</td>\n",
       "      <td>675.348</td>\n",
       "      <td>44835266</td>\n",
       "      <td>3.594664e+08</td>\n",
       "      <td>0.168</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1224</td>\n",
       "      <td>0.041158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>高铁基建股</th>\n",
       "      <td>HK.BK1244</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>491.705</td>\n",
       "      <td>476.432</td>\n",
       "      <td>492.588</td>\n",
       "      <td>474.885</td>\n",
       "      <td>474.135</td>\n",
       "      <td>91826265</td>\n",
       "      <td>4.693082e+08</td>\n",
       "      <td>0.109</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1244</td>\n",
       "      <td>0.037057</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>香港银行股</th>\n",
       "      <td>HK.BK1252</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>577.680</td>\n",
       "      <td>558.774</td>\n",
       "      <td>579.550</td>\n",
       "      <td>556.635</td>\n",
       "      <td>557.255</td>\n",
       "      <td>87796876</td>\n",
       "      <td>3.250828e+09</td>\n",
       "      <td>0.216</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1252</td>\n",
       "      <td>0.036653</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>风电股</th>\n",
       "      <td>HK.BK1237</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>1099.233</td>\n",
       "      <td>1073.983</td>\n",
       "      <td>1127.690</td>\n",
       "      <td>1073.983</td>\n",
       "      <td>1061.375</td>\n",
       "      <td>66294537</td>\n",
       "      <td>3.907131e+08</td>\n",
       "      <td>0.174</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1237</td>\n",
       "      <td>0.035669</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>航空股</th>\n",
       "      <td>HK.BK1240</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>591.057</td>\n",
       "      <td>578.498</td>\n",
       "      <td>596.700</td>\n",
       "      <td>574.603</td>\n",
       "      <td>574.174</td>\n",
       "      <td>111157906</td>\n",
       "      <td>5.838035e+08</td>\n",
       "      <td>0.193</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1240</td>\n",
       "      <td>0.029404</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>港口运输股</th>\n",
       "      <td>HK.BK1213</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>632.569</td>\n",
       "      <td>616.208</td>\n",
       "      <td>636.447</td>\n",
       "      <td>613.291</td>\n",
       "      <td>615.346</td>\n",
       "      <td>85909467</td>\n",
       "      <td>2.969853e+08</td>\n",
       "      <td>0.114</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1213</td>\n",
       "      <td>0.027989</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>汽车经销商</th>\n",
       "      <td>HK.BK1196</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>2774.566</td>\n",
       "      <td>2734.163</td>\n",
       "      <td>2882.720</td>\n",
       "      <td>2727.581</td>\n",
       "      <td>2702.421</td>\n",
       "      <td>37015877</td>\n",
       "      <td>7.479316e+08</td>\n",
       "      <td>0.294</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1196</td>\n",
       "      <td>0.026696</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>内险股</th>\n",
       "      <td>HK.BK1228</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>830.363</td>\n",
       "      <td>806.977</td>\n",
       "      <td>832.953</td>\n",
       "      <td>806.150</td>\n",
       "      <td>808.845</td>\n",
       "      <td>335949679</td>\n",
       "      <td>7.959650e+09</td>\n",
       "      <td>0.194</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1228</td>\n",
       "      <td>0.026603</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>连锁快餐店</th>\n",
       "      <td>HK.BK1225</td>\n",
       "      <td>2020-10-23 15:59:50</td>\n",
       "      <td>592.157</td>\n",
       "      <td>576.187</td>\n",
       "      <td>592.869</td>\n",
       "      <td>576.187</td>\n",
       "      <td>577.038</td>\n",
       "      <td>3822507</td>\n",
       "      <td>3.049677e+07</td>\n",
       "      <td>0.119</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1225</td>\n",
       "      <td>0.026201</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>百货业股</th>\n",
       "      <td>HK.BK1210</td>\n",
       "      <td>2020-10-23 15:59:06</td>\n",
       "      <td>686.072</td>\n",
       "      <td>670.455</td>\n",
       "      <td>687.324</td>\n",
       "      <td>666.000</td>\n",
       "      <td>670.317</td>\n",
       "      <td>4019500</td>\n",
       "      <td>1.811227e+06</td>\n",
       "      <td>0.027</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1210</td>\n",
       "      <td>0.023504</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>工业大麻</th>\n",
       "      <td>HK.BK1992</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>1027.774</td>\n",
       "      <td>1005.163</td>\n",
       "      <td>1029.319</td>\n",
       "      <td>1000.274</td>\n",
       "      <td>1005.163</td>\n",
       "      <td>116073000</td>\n",
       "      <td>6.738206e+07</td>\n",
       "      <td>0.684</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1992</td>\n",
       "      <td>0.022495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>核电</th>\n",
       "      <td>HK.BK1200</td>\n",
       "      <td>2020-10-23 15:59:59</td>\n",
       "      <td>788.610</td>\n",
       "      <td>772.353</td>\n",
       "      <td>788.696</td>\n",
       "      <td>767.728</td>\n",
       "      <td>771.615</td>\n",
       "      <td>18654000</td>\n",
       "      <td>2.668850e+07</td>\n",
       "      <td>0.030</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1200</td>\n",
       "      <td>0.022025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>人民币升值概念</th>\n",
       "      <td>HK.BK1187</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>904.633</td>\n",
       "      <td>891.388</td>\n",
       "      <td>912.214</td>\n",
       "      <td>888.679</td>\n",
       "      <td>886.667</td>\n",
       "      <td>92807292</td>\n",
       "      <td>4.512122e+08</td>\n",
       "      <td>0.159</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1187</td>\n",
       "      <td>0.020262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>婴儿及小童用品股</th>\n",
       "      <td>HK.BK1209</td>\n",
       "      <td>2020-10-23 15:58:39</td>\n",
       "      <td>241.748</td>\n",
       "      <td>241.980</td>\n",
       "      <td>244.116</td>\n",
       "      <td>232.507</td>\n",
       "      <td>237.707</td>\n",
       "      <td>2374000</td>\n",
       "      <td>2.245450e+06</td>\n",
       "      <td>0.053</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1209</td>\n",
       "      <td>0.017000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>光伏太阳能股</th>\n",
       "      <td>HK.BK1233</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>1139.537</td>\n",
       "      <td>1149.803</td>\n",
       "      <td>1158.085</td>\n",
       "      <td>1115.052</td>\n",
       "      <td>1121.164</td>\n",
       "      <td>505240920</td>\n",
       "      <td>8.096054e+08</td>\n",
       "      <td>0.346</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1233</td>\n",
       "      <td>0.016387</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>烟草概念</th>\n",
       "      <td>HK.BK1267</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>2902.719</td>\n",
       "      <td>2860.845</td>\n",
       "      <td>2923.109</td>\n",
       "      <td>2840.591</td>\n",
       "      <td>2857.491</td>\n",
       "      <td>12487171</td>\n",
       "      <td>3.336864e+08</td>\n",
       "      <td>0.110</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1267</td>\n",
       "      <td>0.015828</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>电信股</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-23 16:00:00</td>\n",
       "      <td>646.542</td>\n",
       "      <td>637.816</td>\n",
       "      <td>646.542</td>\n",
       "      <td>632.183</td>\n",
       "      <td>637.223</td>\n",
       "      <td>157432664</td>\n",
       "      <td>1.233921e+09</td>\n",
       "      <td>0.102</td>\n",
       "      <td>...</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>BK1214</td>\n",
       "      <td>0.014624</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20 rows × 134 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 code          update_time  last_price  open_price  \\\n",
       "plate_name                                                           \n",
       "石化股         HK.BK1241  2020-10-23 16:00:00     537.201     502.693   \n",
       "石油股         HK.BK1205  2020-10-23 16:00:00     536.771     506.566   \n",
       "稀土概念        HK.BK1186  2020-10-23 16:00:00     994.945     962.804   \n",
       "电力设备股       HK.BK1224  2020-10-23 16:00:00     703.144     682.908   \n",
       "高铁基建股       HK.BK1244  2020-10-23 16:00:00     491.705     476.432   \n",
       "香港银行股       HK.BK1252  2020-10-23 16:00:00     577.680     558.774   \n",
       "风电股         HK.BK1237  2020-10-23 16:00:00    1099.233    1073.983   \n",
       "航空股         HK.BK1240  2020-10-23 16:00:00     591.057     578.498   \n",
       "港口运输股       HK.BK1213  2020-10-23 16:00:00     632.569     616.208   \n",
       "汽车经销商       HK.BK1196  2020-10-23 16:00:00    2774.566    2734.163   \n",
       "内险股         HK.BK1228  2020-10-23 16:00:00     830.363     806.977   \n",
       "连锁快餐店       HK.BK1225  2020-10-23 15:59:50     592.157     576.187   \n",
       "百货业股        HK.BK1210  2020-10-23 15:59:06     686.072     670.455   \n",
       "工业大麻        HK.BK1992  2020-10-23 16:00:00    1027.774    1005.163   \n",
       "核电          HK.BK1200  2020-10-23 15:59:59     788.610     772.353   \n",
       "人民币升值概念     HK.BK1187  2020-10-23 16:00:00     904.633     891.388   \n",
       "婴儿及小童用品股    HK.BK1209  2020-10-23 15:58:39     241.748     241.980   \n",
       "光伏太阳能股      HK.BK1233  2020-10-23 16:00:00    1139.537    1149.803   \n",
       "烟草概念        HK.BK1267  2020-10-23 16:00:00    2902.719    2860.845   \n",
       "电信股         HK.BK1214  2020-10-23 16:00:00     646.542     637.816   \n",
       "\n",
       "            high_price  low_price  prev_close_price     volume      turnover  \\\n",
       "plate_name                                                                     \n",
       "石化股            537.201    499.443           497.907  272837327  7.676172e+08   \n",
       "石油股            537.811    503.674           502.647  678404412  2.550321e+09   \n",
       "稀土概念          1017.220    962.804           953.847   58541545  4.082278e+08   \n",
       "电力设备股          717.979    682.908           675.348   44835266  3.594664e+08   \n",
       "高铁基建股          492.588    474.885           474.135   91826265  4.693082e+08   \n",
       "香港银行股          579.550    556.635           557.255   87796876  3.250828e+09   \n",
       "风电股           1127.690   1073.983          1061.375   66294537  3.907131e+08   \n",
       "航空股            596.700    574.603           574.174  111157906  5.838035e+08   \n",
       "港口运输股          636.447    613.291           615.346   85909467  2.969853e+08   \n",
       "汽车经销商         2882.720   2727.581          2702.421   37015877  7.479316e+08   \n",
       "内险股            832.953    806.150           808.845  335949679  7.959650e+09   \n",
       "连锁快餐店          592.869    576.187           577.038    3822507  3.049677e+07   \n",
       "百货业股           687.324    666.000           670.317    4019500  1.811227e+06   \n",
       "工业大麻          1029.319   1000.274          1005.163  116073000  6.738206e+07   \n",
       "核电             788.696    767.728           771.615   18654000  2.668850e+07   \n",
       "人民币升值概念        912.214    888.679           886.667   92807292  4.512122e+08   \n",
       "婴儿及小童用品股       244.116    232.507           237.707    2374000  2.245450e+06   \n",
       "光伏太阳能股        1158.085   1115.052          1121.164  505240920  8.096054e+08   \n",
       "烟草概念          2923.109   2840.591          2857.491   12487171  3.336864e+08   \n",
       "电信股            646.542    632.183           637.223  157432664  1.233921e+09   \n",
       "\n",
       "            turnover_rate  ...  pre_change_rate pre_amplitude  after_price  \\\n",
       "plate_name                 ...                                               \n",
       "石化股                 0.159  ...              N/A           N/A          N/A   \n",
       "石油股                 0.181  ...              N/A           N/A          N/A   \n",
       "稀土概念                0.171  ...              N/A           N/A          N/A   \n",
       "电力设备股               0.168  ...              N/A           N/A          N/A   \n",
       "高铁基建股               0.109  ...              N/A           N/A          N/A   \n",
       "香港银行股               0.216  ...              N/A           N/A          N/A   \n",
       "风电股                 0.174  ...              N/A           N/A          N/A   \n",
       "航空股                 0.193  ...              N/A           N/A          N/A   \n",
       "港口运输股               0.114  ...              N/A           N/A          N/A   \n",
       "汽车经销商               0.294  ...              N/A           N/A          N/A   \n",
       "内险股                 0.194  ...              N/A           N/A          N/A   \n",
       "连锁快餐店               0.119  ...              N/A           N/A          N/A   \n",
       "百货业股                0.027  ...              N/A           N/A          N/A   \n",
       "工业大麻                0.684  ...              N/A           N/A          N/A   \n",
       "核电                  0.030  ...              N/A           N/A          N/A   \n",
       "人民币升值概念             0.159  ...              N/A           N/A          N/A   \n",
       "婴儿及小童用品股            0.053  ...              N/A           N/A          N/A   \n",
       "光伏太阳能股              0.346  ...              N/A           N/A          N/A   \n",
       "烟草概念                0.110  ...              N/A           N/A          N/A   \n",
       "电信股                 0.102  ...              N/A           N/A          N/A   \n",
       "\n",
       "            after_high_price  after_low_price  after_change_val  \\\n",
       "plate_name                                                        \n",
       "石化股                      N/A              N/A               N/A   \n",
       "石油股                      N/A              N/A               N/A   \n",
       "稀土概念                     N/A              N/A               N/A   \n",
       "电力设备股                    N/A              N/A               N/A   \n",
       "高铁基建股                    N/A              N/A               N/A   \n",
       "香港银行股                    N/A              N/A               N/A   \n",
       "风电股                      N/A              N/A               N/A   \n",
       "航空股                      N/A              N/A               N/A   \n",
       "港口运输股                    N/A              N/A               N/A   \n",
       "汽车经销商                    N/A              N/A               N/A   \n",
       "内险股                      N/A              N/A               N/A   \n",
       "连锁快餐店                    N/A              N/A               N/A   \n",
       "百货业股                     N/A              N/A               N/A   \n",
       "工业大麻                     N/A              N/A               N/A   \n",
       "核电                       N/A              N/A               N/A   \n",
       "人民币升值概念                  N/A              N/A               N/A   \n",
       "婴儿及小童用品股                 N/A              N/A               N/A   \n",
       "光伏太阳能股                   N/A              N/A               N/A   \n",
       "烟草概念                     N/A              N/A               N/A   \n",
       "电信股                      N/A              N/A               N/A   \n",
       "\n",
       "            after_change_rate  after_amplitude  plate_id  price_change  \n",
       "plate_name                                                              \n",
       "石化股                       N/A              N/A    BK1241      0.078918  \n",
       "石油股                       N/A              N/A    BK1205      0.067889  \n",
       "稀土概念                      N/A              N/A    BK1186      0.043087  \n",
       "电力设备股                     N/A              N/A    BK1224      0.041158  \n",
       "高铁基建股                     N/A              N/A    BK1244      0.037057  \n",
       "香港银行股                     N/A              N/A    BK1252      0.036653  \n",
       "风电股                       N/A              N/A    BK1237      0.035669  \n",
       "航空股                       N/A              N/A    BK1240      0.029404  \n",
       "港口运输股                     N/A              N/A    BK1213      0.027989  \n",
       "汽车经销商                     N/A              N/A    BK1196      0.026696  \n",
       "内险股                       N/A              N/A    BK1228      0.026603  \n",
       "连锁快餐店                     N/A              N/A    BK1225      0.026201  \n",
       "百货业股                      N/A              N/A    BK1210      0.023504  \n",
       "工业大麻                      N/A              N/A    BK1992      0.022495  \n",
       "核电                        N/A              N/A    BK1200      0.022025  \n",
       "人民币升值概念                   N/A              N/A    BK1187      0.020262  \n",
       "婴儿及小童用品股                  N/A              N/A    BK1209      0.017000  \n",
       "光伏太阳能股                    N/A              N/A    BK1233      0.016387  \n",
       "烟草概念                      N/A              N/A    BK1267      0.015828  \n",
       "电信股                       N/A              N/A    BK1214      0.014624  \n",
       "\n",
       "[20 rows x 134 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_plate"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2020-10-24 18:14:14,937 [open_context_base.py] _socket_reconnect_and_wait_ready:255: Start connecting: host=127.0.0.1; port=11111;\n",
      "2020-10-24 18:14:14,939 [open_context_base.py] on_connected:344: Connected : conn_id=3; \n",
      "2020-10-24 18:14:14,942 [open_context_base.py] _handle_init_connect:445: InitConnect ok: conn_id=3; info={'server_version': 217, 'login_user_id': 7182561, 'conn_id': 6725710978492350411, 'conn_key': '913C2832D791A470', 'conn_iv': 'E3324EBA053078A6', 'keep_alive_interval': 10, 'is_encrypt': False};\n",
      "2020-10-24 18:14:15,808 [network_manager.py] work:366: Close: conn_id=3\n"
     ]
    }
   ],
   "source": [
    "quote_ctx = OpenQuoteContext(host='127.0.0.1', port=11111)\n",
    "data_plate_top_20_table = []\n",
    "for i in data_plate_top_20:\n",
    "    ret, history_data, page_req_key = quote_ctx.request_history_kline(i, start='2020-10-19', end='2020-10-23')  #拿取最近5日板塊數據\n",
    "    if ret == RET_OK:\n",
    "        data_plate_top_20_table.append(history_data) #逐一把板塊數據加入去data_plate_top_20_table這varaible\n",
    "    else:\n",
    "        print('error:', data)\n",
    "quote_ctx.close() # 結束後記得關閉當條連接，防止連接條數用盡"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[        code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1241  2020-10-19 00:00:00  500.854  505.374  509.177  497.813   \n",
       " 1  HK.BK1241  2020-10-20 00:00:00  500.749  494.218  500.749  492.632   \n",
       " 2  HK.BK1241  2020-10-21 00:00:00  498.866  495.767  499.281  494.066   \n",
       " 3  HK.BK1241  2020-10-22 00:00:00  494.485  497.907  499.595  490.860   \n",
       " 4  HK.BK1241  2020-10-23 00:00:00  502.693  537.201  537.201  499.443   \n",
       " \n",
       "    pe_ratio  turnover_rate     volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  188895610  446230268.0     0.902459     500.935  \n",
       " 1       0.0            0.0  133881936  357008267.0    -2.207474     505.374  \n",
       " 2       0.0            0.0   77815861  205591560.0     0.313424     494.218  \n",
       " 3       0.0            0.0  112185126  277481296.0     0.431654     495.767  \n",
       " 4       0.0            0.0  272837327  767617226.0     7.891835     497.907  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1205  2020-10-19 00:00:00  508.010  512.603  514.858  506.063   \n",
       " 1  HK.BK1205  2020-10-20 00:00:00  510.980  504.813  511.689  502.638   \n",
       " 2  HK.BK1205  2020-10-21 00:00:00  507.249  506.392  509.104  503.308   \n",
       " 3  HK.BK1205  2020-10-22 00:00:00  503.514  502.647  504.954  499.037   \n",
       " 4  HK.BK1205  2020-10-23 00:00:00  506.566  536.771  537.811  503.674   \n",
       " \n",
       "    pe_ratio  turnover_rate     volume      turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  288973629  9.886148e+08     0.904116     508.610  \n",
       " 1       0.0            0.0  255243090  9.950382e+08    -1.519695     512.603  \n",
       " 2       0.0            0.0  193947568  8.147188e+08     0.312789     504.813  \n",
       " 3       0.0            0.0  267437291  1.142037e+09    -0.739546     506.392  \n",
       " 4       0.0            0.0  678404412  2.550321e+09     6.788860     502.647  ,\n",
       "         code             time_key     open    close      high      low  \\\n",
       " 0  HK.BK1186  2020-10-19 00:00:00  961.025  965.261   987.542  959.796   \n",
       " 1  HK.BK1186  2020-10-20 00:00:00  969.145  948.233   976.629  938.336   \n",
       " 2  HK.BK1186  2020-10-21 00:00:00  961.147  966.858   978.112  954.942   \n",
       " 3  HK.BK1186  2020-10-22 00:00:00  968.207  953.847   974.429  947.223   \n",
       " 4  HK.BK1186  2020-10-23 00:00:00  962.804  994.945  1017.220  962.804   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  42418282  323053844.0     0.641009     959.113  \n",
       " 1       0.0            0.0  26434629  159261294.0    -1.764082     965.261  \n",
       " 2       0.0            0.0  37061023  195354766.0     1.964180     948.233  \n",
       " 3       0.0            0.0  21147349  120841087.0    -1.345699     966.858  \n",
       " 4       0.0            0.0  58541545  408227826.0     4.308657     953.847  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1224  2020-10-19 00:00:00  706.562  690.769  718.311  686.102   \n",
       " 1  HK.BK1224  2020-10-20 00:00:00  697.921  685.110  699.974  680.363   \n",
       " 2  HK.BK1224  2020-10-21 00:00:00  690.480  678.411  693.863  676.845   \n",
       " 3  HK.BK1224  2020-10-22 00:00:00  679.260  675.348  684.412  671.920   \n",
       " 4  HK.BK1224  2020-10-23 00:00:00  682.908  703.144  717.979  682.908   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  50454010  355476654.0    -2.235190     700.184  \n",
       " 1       0.0            0.0  33606077  209305006.0    -0.819232     690.769  \n",
       " 2       0.0            0.0  28637528  165510329.0    -0.977799     685.110  \n",
       " 3       0.0            0.0  17305985  113954090.0    -0.451496     678.411  \n",
       " 4       0.0            0.0  44835266  359466431.0     4.115804     675.348  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1244  2020-10-19 00:00:00  480.534  484.885  491.166  479.485   \n",
       " 1  HK.BK1244  2020-10-20 00:00:00  485.808  476.671  486.642  475.364   \n",
       " 2  HK.BK1244  2020-10-21 00:00:00  480.136  479.309  484.301  477.868   \n",
       " 3  HK.BK1244  2020-10-22 00:00:00  480.839  474.135  481.151  473.779   \n",
       " 4  HK.BK1244  2020-10-23 00:00:00  476.432  491.705  492.588  474.885   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  55936089  339685770.0     0.905451     479.087  \n",
       " 1       0.0            0.0  39975338  221467202.0    -1.694010     484.885  \n",
       " 2       0.0            0.0  34699179  206347707.0     0.553422     476.671  \n",
       " 3       0.0            0.0  42492107  216941866.0    -1.079471     479.309  \n",
       " 4       0.0            0.0  91826265  469308196.0     3.705696     474.135  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1252  2020-10-19 00:00:00  547.700  551.539  556.720  546.011   \n",
       " 1  HK.BK1252  2020-10-20 00:00:00  550.793  549.900  554.868  545.954   \n",
       " 2  HK.BK1252  2020-10-21 00:00:00  553.413  556.282  558.191  551.343   \n",
       " 3  HK.BK1252  2020-10-22 00:00:00  551.293  557.255  558.090  551.293   \n",
       " 4  HK.BK1252  2020-10-23 00:00:00  558.774  577.680  579.550  556.635   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume      turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  38485089  1.325985e+09     0.700931     542.600  \n",
       " 1       0.0            0.0  31714781  1.163896e+09    -0.297168     551.539  \n",
       " 2       0.0            0.0  25046183  8.487980e+08     1.160575     549.900  \n",
       " 3       0.0            0.0  31714617  9.507370e+08     0.174911     556.282  \n",
       " 4       0.0            0.0  87796876  3.250828e+09     3.665288     557.255  ,\n",
       "         code             time_key      open     close      high       low  \\\n",
       " 0  HK.BK1237  2020-10-19 00:00:00  1094.430  1111.156  1124.841  1094.430   \n",
       " 1  HK.BK1237  2020-10-20 00:00:00  1120.897  1076.670  1124.629  1070.148   \n",
       " 2  HK.BK1237  2020-10-21 00:00:00  1085.358  1064.733  1097.026  1061.541   \n",
       " 3  HK.BK1237  2020-10-22 00:00:00  1073.801  1061.375  1079.244  1049.987   \n",
       " 4  HK.BK1237  2020-10-23 00:00:00  1073.983  1099.233  1127.690  1073.983   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  60628421  391113710.0     1.528284    1094.072  \n",
       " 1       0.0            0.0  57508644  276306743.0    -3.103615    1111.156  \n",
       " 2       0.0            0.0  59444682  241040194.0    -1.108696    1076.670  \n",
       " 3       0.0            0.0  44081791  175114192.0    -0.315384    1064.733  \n",
       " 4       0.0            0.0  66294537  390713075.0     3.566883    1061.375  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1240  2020-10-19 00:00:00  561.864  564.230  571.793  561.292   \n",
       " 1  HK.BK1240  2020-10-20 00:00:00  563.854  565.902  566.560  560.470   \n",
       " 2  HK.BK1240  2020-10-21 00:00:00  568.054  577.585  584.139  566.596   \n",
       " 3  HK.BK1240  2020-10-22 00:00:00  580.661  574.174  582.168  567.002   \n",
       " 4  HK.BK1240  2020-10-23 00:00:00  578.498  591.057  596.700  574.603   \n",
       " \n",
       "    pe_ratio  turnover_rate     volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0   48436853  296915230.0     0.421098     561.862  \n",
       " 1       0.0            0.0   30369657  196053341.0     0.296333     564.230  \n",
       " 2       0.0            0.0   89644024  465755835.0     2.064492     565.902  \n",
       " 3       0.0            0.0   55727790  285283510.0    -0.590562     577.585  \n",
       " 4       0.0            0.0  111157906  583803534.0     2.940398     574.174  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1213  2020-10-19 00:00:00  619.129  607.881  623.978  606.928   \n",
       " 1  HK.BK1213  2020-10-20 00:00:00  607.853  606.448  608.973  601.134   \n",
       " 2  HK.BK1213  2020-10-21 00:00:00  608.132  615.104  616.829  605.429   \n",
       " 3  HK.BK1213  2020-10-22 00:00:00  613.662  615.346  623.659  611.741   \n",
       " 4  HK.BK1213  2020-10-23 00:00:00  616.208  632.569  636.447  613.291   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  46612811  143950558.0    -1.816746     617.073  \n",
       " 1       0.0            0.0  52935899  140567466.0    -0.235737     607.881  \n",
       " 2       0.0            0.0  79289987  217708990.0     1.427328     606.448  \n",
       " 3       0.0            0.0  66395462  166361107.0     0.039343     615.104  \n",
       " 4       0.0            0.0  85909467  296985326.0     2.798913     615.346  ,\n",
       "         code             time_key      open     close      high       low  \\\n",
       " 0  HK.BK1196  2020-10-19 00:00:00  2506.229  2489.957  2529.304  2485.897   \n",
       " 1  HK.BK1196  2020-10-20 00:00:00  2550.903  2634.312  2635.185  2503.476   \n",
       " 2  HK.BK1196  2020-10-21 00:00:00  2673.028  2751.081  2779.658  2664.044   \n",
       " 3  HK.BK1196  2020-10-22 00:00:00  2766.422  2702.421  2775.164  2696.752   \n",
       " 4  HK.BK1196  2020-10-23 00:00:00  2734.163  2774.566  2882.720  2727.581   \n",
       " \n",
       "    pe_ratio  turnover_rate     volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  131965367  344060097.0    -0.649262    2499.435  \n",
       " 1       0.0            0.0   38615685  548768466.0     5.797490    2489.957  \n",
       " 2       0.0            0.0   39995387  744766252.0     4.432618    2634.312  \n",
       " 3       0.0            0.0   16966456  285388769.0    -1.768759    2751.081  \n",
       " 4       0.0            0.0   37015877  747931590.0     2.669643    2702.421  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1228  2020-10-19 00:00:00  800.822  807.554  822.689  800.576   \n",
       " 1  HK.BK1228  2020-10-20 00:00:00  809.481  809.336  811.613  803.106   \n",
       " 2  HK.BK1228  2020-10-21 00:00:00  813.593  809.013  817.815  807.087   \n",
       " 3  HK.BK1228  2020-10-22 00:00:00  803.464  808.845  811.141  799.431   \n",
       " 4  HK.BK1228  2020-10-23 00:00:00  806.977  830.363  832.953  806.150   \n",
       " \n",
       "    pe_ratio  turnover_rate     volume      turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  276056565  6.380211e+09     1.159847     798.295  \n",
       " 1       0.0            0.0  168254319  3.929656e+09     0.220666     807.554  \n",
       " 2       0.0            0.0  222247560  4.165898e+09    -0.039909     809.336  \n",
       " 3       0.0            0.0  177384322  3.106411e+09    -0.020766     809.013  \n",
       " 4       0.0            0.0  335949679  7.959650e+09     2.660337     808.845  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1225  2020-10-19 00:00:00  590.542  587.297  592.912  585.420   \n",
       " 1  HK.BK1225  2020-10-20 00:00:00  588.936  580.220  588.936  575.325   \n",
       " 2  HK.BK1225  2020-10-21 00:00:00  580.913  581.846  584.553  579.464   \n",
       " 3  HK.BK1225  2020-10-22 00:00:00  583.884  577.038  585.333  575.333   \n",
       " 4  HK.BK1225  2020-10-23 00:00:00  576.187  592.157  592.869  576.187   \n",
       " \n",
       "    pe_ratio  turnover_rate   volume    turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  1123500   7361040.0    -0.549495     587.769  \n",
       " 1       0.0            0.0  1946933  21187025.0    -1.205012     587.297  \n",
       " 2       0.0            0.0  2793516  13473668.0     0.280239     580.220  \n",
       " 3       0.0            0.0  2260232  15122475.0    -0.826335     581.846  \n",
       " 4       0.0            0.0  3822507  30496770.0     2.620105     577.038  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1210  2020-10-19 00:00:00  667.696  667.740  670.496  664.583   \n",
       " 1  HK.BK1210  2020-10-20 00:00:00  668.379  670.920  674.181  664.439   \n",
       " 2  HK.BK1210  2020-10-21 00:00:00  671.883  667.225  672.340  667.225   \n",
       " 3  HK.BK1210  2020-10-22 00:00:00  668.682  670.317  671.970  662.420   \n",
       " 4  HK.BK1210  2020-10-23 00:00:00  670.455  686.072  687.324  666.000   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume   turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  14366000  3637753.0     0.108843     667.014  \n",
       " 1       0.0            0.0  16477000  6531555.0     0.476233     667.740  \n",
       " 2       0.0            0.0   8115000  2560726.0    -0.550736     670.920  \n",
       " 3       0.0            0.0  11093000  3775836.0     0.463412     667.225  \n",
       " 4       0.0            0.0   4019500  1811227.0     2.350380     670.317  ,\n",
       "         code             time_key      open     close      high       low  \\\n",
       " 0  HK.BK1992  2020-10-19 00:00:00  1012.102  1031.256  1049.995   998.705   \n",
       " 1  HK.BK1992  2020-10-20 00:00:00  1031.753  1005.938  1041.646   999.364   \n",
       " 2  HK.BK1992  2020-10-21 00:00:00  1012.347  1004.332  1021.908  1001.122   \n",
       " 3  HK.BK1992  2020-10-22 00:00:00  1011.093  1005.163  1015.695   994.575   \n",
       " 4  HK.BK1992  2020-10-23 00:00:00  1005.163  1027.774  1029.319  1000.274   \n",
       " \n",
       "    pe_ratio  turnover_rate     volume    turnover  change_rate  last_close  \n",
       " 0       0.0            0.0   35287400  63281340.0     1.892497    1006.638  \n",
       " 1       0.0            0.0   19194000  28346630.0    -2.455065    1031.256  \n",
       " 2       0.0            0.0   14807000  18708809.0    -0.159652    1005.938  \n",
       " 3       0.0            0.0   12825000  21002940.0     0.082742    1004.332  \n",
       " 4       0.0            0.0  116073000  67382060.0     2.249486    1005.163  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1200  2020-10-19 00:00:00  775.673  787.958  789.064  771.332   \n",
       " 1  HK.BK1200  2020-10-20 00:00:00  783.986  771.332  792.668  766.991   \n",
       " 2  HK.BK1200  2020-10-21 00:00:00  780.383  780.950  785.943  771.332   \n",
       " 3  HK.BK1200  2020-10-22 00:00:00  780.581  771.615  784.922  767.274   \n",
       " 4  HK.BK1200  2020-10-23 00:00:00  772.353  788.610  788.696  767.728   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume    turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  33629914  48207658.0     1.583786     770.963  \n",
       " 1       0.0            0.0  22662802  33154150.0    -2.110011     787.958  \n",
       " 2       0.0            0.0  13950000  20664015.0     1.246934     771.332  \n",
       " 3       0.0            0.0  17271000  25564135.0    -1.195339     780.950  \n",
       " 4       0.0            0.0  18654000  26688500.0     2.202523     771.615  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1187  2020-10-19 00:00:00  849.570  861.540  863.157  847.898   \n",
       " 1  HK.BK1187  2020-10-20 00:00:00  858.811  873.604  874.375  855.119   \n",
       " 2  HK.BK1187  2020-10-21 00:00:00  875.841  888.584  895.039  874.066   \n",
       " 3  HK.BK1187  2020-10-22 00:00:00  892.359  886.667  892.359  873.018   \n",
       " 4  HK.BK1187  2020-10-23 00:00:00  891.388  904.633  912.214  888.679   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  55657437  361373653.0     1.727216     846.912  \n",
       " 1       0.0            0.0  50619110  396311972.0     1.400283     861.540  \n",
       " 2       0.0            0.0  85845300  485976682.0     1.714736     873.604  \n",
       " 3       0.0            0.0  45809956  244639790.0    -0.215736     888.584  \n",
       " 4       0.0            0.0  92807292  451212204.0     2.026240     886.667  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1209  2020-10-19 00:00:00  256.083  253.019  262.492  245.401   \n",
       " 1  HK.BK1209  2020-10-20 00:00:00  246.379  241.874  248.283  237.601   \n",
       " 2  HK.BK1209  2020-10-21 00:00:00  244.242  239.844  246.379  231.424   \n",
       " 3  HK.BK1209  2020-10-22 00:00:00  235.571  237.707  244.116  235.571   \n",
       " 4  HK.BK1209  2020-10-23 00:00:00  241.980  241.748  244.116  232.507   \n",
       " \n",
       "    pe_ratio  turnover_rate   volume   turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  2015000  2069086.0    -1.196487     252.556  \n",
       " 1       0.0            0.0  1820000  1465398.0    -4.404808     253.019  \n",
       " 2       0.0            0.0  3102000  3070410.0    -0.839280     241.874  \n",
       " 3       0.0            0.0  1139000   415966.0    -0.890996     239.844  \n",
       " 4       0.0            0.0  2374000  2245450.0     1.699992     237.707  ,\n",
       "         code             time_key      open     close      high       low  \\\n",
       " 0  HK.BK1233  2020-10-19 00:00:00  1183.725  1113.617  1194.557  1102.806   \n",
       " 1  HK.BK1233  2020-10-20 00:00:00  1128.417  1167.601  1170.313  1124.289   \n",
       " 2  HK.BK1233  2020-10-21 00:00:00  1190.139  1163.077  1193.945  1154.091   \n",
       " 3  HK.BK1233  2020-10-22 00:00:00  1149.442  1121.164  1163.588  1090.484   \n",
       " 4  HK.BK1233  2020-10-23 00:00:00  1149.803  1139.537  1158.085  1115.052   \n",
       " \n",
       "    pe_ratio  turnover_rate     volume      turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  938571933  1.204075e+09    -3.730973    1156.776  \n",
       " 1       0.0            0.0  310087990  6.053892e+08     4.847627    1113.617  \n",
       " 2       0.0            0.0  676300626  8.785652e+08    -0.387461    1167.601  \n",
       " 3       0.0            0.0  529511187  8.837492e+08    -3.603631    1163.077  \n",
       " 4       0.0            0.0  505240920  8.096054e+08     1.638743    1121.164  ,\n",
       "         code             time_key      open     close      high       low  \\\n",
       " 0  HK.BK1267  2020-10-19 00:00:00  3017.199  2850.830  3022.960  2844.946   \n",
       " 1  HK.BK1267  2020-10-20 00:00:00  2853.294  2941.040  2941.716  2846.721   \n",
       " 2  HK.BK1267  2020-10-21 00:00:00  2939.753  2869.164  2939.753  2848.285   \n",
       " 3  HK.BK1267  2020-10-22 00:00:00  2888.558  2857.491  2899.607  2825.421   \n",
       " 4  HK.BK1267  2020-10-23 00:00:00  2860.845  2902.719  2923.109  2840.591   \n",
       " \n",
       "    pe_ratio  turnover_rate    volume     turnover  change_rate  last_close  \n",
       " 0       0.0            0.0  13628505  378020661.0    -5.236030    3008.348  \n",
       " 1       0.0            0.0   8150398  215368305.0     3.164342    2850.830  \n",
       " 2       0.0            0.0   9332320  276161314.0    -2.443897    2941.040  \n",
       " 3       0.0            0.0  10072386  258148090.0    -0.406843    2869.164  \n",
       " 4       0.0            0.0  12487171  333686365.0     1.582787    2857.491  ,\n",
       "         code             time_key     open    close     high      low  \\\n",
       " 0  HK.BK1214  2020-10-19 00:00:00  630.828  632.676  638.241  629.235   \n",
       " 1  HK.BK1214  2020-10-20 00:00:00  630.379  631.830  634.899  629.233   \n",
       " 2  HK.BK1214  2020-10-21 00:00:00  635.501  664.024  671.202  634.101   \n",
       " 3  HK.BK1214  2020-10-22 00:00:00  652.729  637.223  653.270  636.367   \n",
       " 4  HK.BK1214  2020-10-23 00:00:00  637.816  646.542  646.542  632.183   \n",
       " \n",
       "    pe_ratio  turnover_rate     volume      turnover  change_rate  last_close  \n",
       " 0       0.0            0.0   94889857  9.040565e+08     0.292948     633.495  \n",
       " 1       0.0            0.0  151809311  1.130378e+09    -0.133718     632.676  \n",
       " 2       0.0            0.0  312443390  3.094369e+09     5.095358     631.830  \n",
       " 3       0.0            0.0  283284340  2.055431e+09    -4.036149     664.024  \n",
       " 4       0.0            0.0  157432664  1.233921e+09     1.462439     637.223  ]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_plate_top_20_table #頭20大升幅板塊過往5日數據"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_plate_top_20_table = pd.concat(data_plate_top_20_table, ignore_index= True) #變成DataFrame格式方便分析"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code</th>\n",
       "      <th>time_key</th>\n",
       "      <th>open</th>\n",
       "      <th>close</th>\n",
       "      <th>high</th>\n",
       "      <th>low</th>\n",
       "      <th>pe_ratio</th>\n",
       "      <th>turnover_rate</th>\n",
       "      <th>volume</th>\n",
       "      <th>turnover</th>\n",
       "      <th>change_rate</th>\n",
       "      <th>last_close</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-19 00:00:00</td>\n",
       "      <td>500.854</td>\n",
       "      <td>505.374</td>\n",
       "      <td>509.177</td>\n",
       "      <td>497.813</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>188895610</td>\n",
       "      <td>4.462303e+08</td>\n",
       "      <td>0.902459</td>\n",
       "      <td>500.935</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-20 00:00:00</td>\n",
       "      <td>500.749</td>\n",
       "      <td>494.218</td>\n",
       "      <td>500.749</td>\n",
       "      <td>492.632</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>133881936</td>\n",
       "      <td>3.570083e+08</td>\n",
       "      <td>-2.207474</td>\n",
       "      <td>505.374</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-21 00:00:00</td>\n",
       "      <td>498.866</td>\n",
       "      <td>495.767</td>\n",
       "      <td>499.281</td>\n",
       "      <td>494.066</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>77815861</td>\n",
       "      <td>2.055916e+08</td>\n",
       "      <td>0.313424</td>\n",
       "      <td>494.218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-22 00:00:00</td>\n",
       "      <td>494.485</td>\n",
       "      <td>497.907</td>\n",
       "      <td>499.595</td>\n",
       "      <td>490.860</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>112185126</td>\n",
       "      <td>2.774813e+08</td>\n",
       "      <td>0.431654</td>\n",
       "      <td>495.767</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-23 00:00:00</td>\n",
       "      <td>502.693</td>\n",
       "      <td>537.201</td>\n",
       "      <td>537.201</td>\n",
       "      <td>499.443</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>272837327</td>\n",
       "      <td>7.676172e+08</td>\n",
       "      <td>7.891835</td>\n",
       "      <td>497.907</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-19 00:00:00</td>\n",
       "      <td>630.828</td>\n",
       "      <td>632.676</td>\n",
       "      <td>638.241</td>\n",
       "      <td>629.235</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>94889857</td>\n",
       "      <td>9.040565e+08</td>\n",
       "      <td>0.292948</td>\n",
       "      <td>633.495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-20 00:00:00</td>\n",
       "      <td>630.379</td>\n",
       "      <td>631.830</td>\n",
       "      <td>634.899</td>\n",
       "      <td>629.233</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>151809311</td>\n",
       "      <td>1.130378e+09</td>\n",
       "      <td>-0.133718</td>\n",
       "      <td>632.676</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-21 00:00:00</td>\n",
       "      <td>635.501</td>\n",
       "      <td>664.024</td>\n",
       "      <td>671.202</td>\n",
       "      <td>634.101</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>312443390</td>\n",
       "      <td>3.094369e+09</td>\n",
       "      <td>5.095358</td>\n",
       "      <td>631.830</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-22 00:00:00</td>\n",
       "      <td>652.729</td>\n",
       "      <td>637.223</td>\n",
       "      <td>653.270</td>\n",
       "      <td>636.367</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>283284340</td>\n",
       "      <td>2.055431e+09</td>\n",
       "      <td>-4.036149</td>\n",
       "      <td>664.024</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-23 00:00:00</td>\n",
       "      <td>637.816</td>\n",
       "      <td>646.542</td>\n",
       "      <td>646.542</td>\n",
       "      <td>632.183</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>157432664</td>\n",
       "      <td>1.233921e+09</td>\n",
       "      <td>1.462439</td>\n",
       "      <td>637.223</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         code             time_key     open    close     high      low  \\\n",
       "0   HK.BK1241  2020-10-19 00:00:00  500.854  505.374  509.177  497.813   \n",
       "1   HK.BK1241  2020-10-20 00:00:00  500.749  494.218  500.749  492.632   \n",
       "2   HK.BK1241  2020-10-21 00:00:00  498.866  495.767  499.281  494.066   \n",
       "3   HK.BK1241  2020-10-22 00:00:00  494.485  497.907  499.595  490.860   \n",
       "4   HK.BK1241  2020-10-23 00:00:00  502.693  537.201  537.201  499.443   \n",
       "..        ...                  ...      ...      ...      ...      ...   \n",
       "95  HK.BK1214  2020-10-19 00:00:00  630.828  632.676  638.241  629.235   \n",
       "96  HK.BK1214  2020-10-20 00:00:00  630.379  631.830  634.899  629.233   \n",
       "97  HK.BK1214  2020-10-21 00:00:00  635.501  664.024  671.202  634.101   \n",
       "98  HK.BK1214  2020-10-22 00:00:00  652.729  637.223  653.270  636.367   \n",
       "99  HK.BK1214  2020-10-23 00:00:00  637.816  646.542  646.542  632.183   \n",
       "\n",
       "    pe_ratio  turnover_rate     volume      turnover  change_rate  last_close  \n",
       "0        0.0            0.0  188895610  4.462303e+08     0.902459     500.935  \n",
       "1        0.0            0.0  133881936  3.570083e+08    -2.207474     505.374  \n",
       "2        0.0            0.0   77815861  2.055916e+08     0.313424     494.218  \n",
       "3        0.0            0.0  112185126  2.774813e+08     0.431654     495.767  \n",
       "4        0.0            0.0  272837327  7.676172e+08     7.891835     497.907  \n",
       "..       ...            ...        ...           ...          ...         ...  \n",
       "95       0.0            0.0   94889857  9.040565e+08     0.292948     633.495  \n",
       "96       0.0            0.0  151809311  1.130378e+09    -0.133718     632.676  \n",
       "97       0.0            0.0  312443390  3.094369e+09     5.095358     631.830  \n",
       "98       0.0            0.0  283284340  2.055431e+09    -4.036149     664.024  \n",
       "99       0.0            0.0  157432664  1.233921e+09     1.462439     637.223  \n",
       "\n",
       "[100 rows x 12 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_plate_top_20_table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_plate_top_20_table = data_plate_top_20_table.merge(data, on='code', how='left') \n",
    "#把香港板塊的名字加入返頭20大升幅板塊過往5日數據的表格"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code</th>\n",
       "      <th>time_key</th>\n",
       "      <th>open</th>\n",
       "      <th>close</th>\n",
       "      <th>high</th>\n",
       "      <th>low</th>\n",
       "      <th>pe_ratio</th>\n",
       "      <th>turnover_rate</th>\n",
       "      <th>volume</th>\n",
       "      <th>turnover</th>\n",
       "      <th>change_rate</th>\n",
       "      <th>last_close</th>\n",
       "      <th>plate_name</th>\n",
       "      <th>plate_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-19 00:00:00</td>\n",
       "      <td>500.854</td>\n",
       "      <td>505.374</td>\n",
       "      <td>509.177</td>\n",
       "      <td>497.813</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>188895610</td>\n",
       "      <td>4.462303e+08</td>\n",
       "      <td>0.902459</td>\n",
       "      <td>500.935</td>\n",
       "      <td>石化股</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-20 00:00:00</td>\n",
       "      <td>500.749</td>\n",
       "      <td>494.218</td>\n",
       "      <td>500.749</td>\n",
       "      <td>492.632</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>133881936</td>\n",
       "      <td>3.570083e+08</td>\n",
       "      <td>-2.207474</td>\n",
       "      <td>505.374</td>\n",
       "      <td>石化股</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-21 00:00:00</td>\n",
       "      <td>498.866</td>\n",
       "      <td>495.767</td>\n",
       "      <td>499.281</td>\n",
       "      <td>494.066</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>77815861</td>\n",
       "      <td>2.055916e+08</td>\n",
       "      <td>0.313424</td>\n",
       "      <td>494.218</td>\n",
       "      <td>石化股</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-22 00:00:00</td>\n",
       "      <td>494.485</td>\n",
       "      <td>497.907</td>\n",
       "      <td>499.595</td>\n",
       "      <td>490.860</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>112185126</td>\n",
       "      <td>2.774813e+08</td>\n",
       "      <td>0.431654</td>\n",
       "      <td>495.767</td>\n",
       "      <td>石化股</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>HK.BK1241</td>\n",
       "      <td>2020-10-23 00:00:00</td>\n",
       "      <td>502.693</td>\n",
       "      <td>537.201</td>\n",
       "      <td>537.201</td>\n",
       "      <td>499.443</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>272837327</td>\n",
       "      <td>7.676172e+08</td>\n",
       "      <td>7.891835</td>\n",
       "      <td>497.907</td>\n",
       "      <td>石化股</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-19 00:00:00</td>\n",
       "      <td>630.828</td>\n",
       "      <td>632.676</td>\n",
       "      <td>638.241</td>\n",
       "      <td>629.235</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>94889857</td>\n",
       "      <td>9.040565e+08</td>\n",
       "      <td>0.292948</td>\n",
       "      <td>633.495</td>\n",
       "      <td>电信股</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-20 00:00:00</td>\n",
       "      <td>630.379</td>\n",
       "      <td>631.830</td>\n",
       "      <td>634.899</td>\n",
       "      <td>629.233</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>151809311</td>\n",
       "      <td>1.130378e+09</td>\n",
       "      <td>-0.133718</td>\n",
       "      <td>632.676</td>\n",
       "      <td>电信股</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-21 00:00:00</td>\n",
       "      <td>635.501</td>\n",
       "      <td>664.024</td>\n",
       "      <td>671.202</td>\n",
       "      <td>634.101</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>312443390</td>\n",
       "      <td>3.094369e+09</td>\n",
       "      <td>5.095358</td>\n",
       "      <td>631.830</td>\n",
       "      <td>电信股</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-22 00:00:00</td>\n",
       "      <td>652.729</td>\n",
       "      <td>637.223</td>\n",
       "      <td>653.270</td>\n",
       "      <td>636.367</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>283284340</td>\n",
       "      <td>2.055431e+09</td>\n",
       "      <td>-4.036149</td>\n",
       "      <td>664.024</td>\n",
       "      <td>电信股</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>HK.BK1214</td>\n",
       "      <td>2020-10-23 00:00:00</td>\n",
       "      <td>637.816</td>\n",
       "      <td>646.542</td>\n",
       "      <td>646.542</td>\n",
       "      <td>632.183</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>157432664</td>\n",
       "      <td>1.233921e+09</td>\n",
       "      <td>1.462439</td>\n",
       "      <td>637.223</td>\n",
       "      <td>电信股</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         code             time_key     open    close     high      low  \\\n",
       "0   HK.BK1241  2020-10-19 00:00:00  500.854  505.374  509.177  497.813   \n",
       "1   HK.BK1241  2020-10-20 00:00:00  500.749  494.218  500.749  492.632   \n",
       "2   HK.BK1241  2020-10-21 00:00:00  498.866  495.767  499.281  494.066   \n",
       "3   HK.BK1241  2020-10-22 00:00:00  494.485  497.907  499.595  490.860   \n",
       "4   HK.BK1241  2020-10-23 00:00:00  502.693  537.201  537.201  499.443   \n",
       "..        ...                  ...      ...      ...      ...      ...   \n",
       "95  HK.BK1214  2020-10-19 00:00:00  630.828  632.676  638.241  629.235   \n",
       "96  HK.BK1214  2020-10-20 00:00:00  630.379  631.830  634.899  629.233   \n",
       "97  HK.BK1214  2020-10-21 00:00:00  635.501  664.024  671.202  634.101   \n",
       "98  HK.BK1214  2020-10-22 00:00:00  652.729  637.223  653.270  636.367   \n",
       "99  HK.BK1214  2020-10-23 00:00:00  637.816  646.542  646.542  632.183   \n",
       "\n",
       "    pe_ratio  turnover_rate     volume      turnover  change_rate  last_close  \\\n",
       "0        0.0            0.0  188895610  4.462303e+08     0.902459     500.935   \n",
       "1        0.0            0.0  133881936  3.570083e+08    -2.207474     505.374   \n",
       "2        0.0            0.0   77815861  2.055916e+08     0.313424     494.218   \n",
       "3        0.0            0.0  112185126  2.774813e+08     0.431654     495.767   \n",
       "4        0.0            0.0  272837327  7.676172e+08     7.891835     497.907   \n",
       "..       ...            ...        ...           ...          ...         ...   \n",
       "95       0.0            0.0   94889857  9.040565e+08     0.292948     633.495   \n",
       "96       0.0            0.0  151809311  1.130378e+09    -0.133718     632.676   \n",
       "97       0.0            0.0  312443390  3.094369e+09     5.095358     631.830   \n",
       "98       0.0            0.0  283284340  2.055431e+09    -4.036149     664.024   \n",
       "99       0.0            0.0  157432664  1.233921e+09     1.462439     637.223   \n",
       "\n",
       "   plate_name plate_id  \n",
       "0         石化股   BK1241  \n",
       "1         石化股   BK1241  \n",
       "2         石化股   BK1241  \n",
       "3         石化股   BK1241  \n",
       "4         石化股   BK1241  \n",
       "..        ...      ...  \n",
       "95        电信股   BK1214  \n",
       "96        电信股   BK1214  \n",
       "97        电信股   BK1214  \n",
       "98        电信股   BK1214  \n",
       "99        电信股   BK1214  \n",
       "\n",
       "[100 rows x 14 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_plate_top_20_table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "new_table = data_plate_top_20_table.set_index(['code', 'plate_name', 'time_key']) #把香港板塊的代號﹐名字及時間變成索引"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>open</th>\n",
       "      <th>close</th>\n",
       "      <th>high</th>\n",
       "      <th>low</th>\n",
       "      <th>pe_ratio</th>\n",
       "      <th>turnover_rate</th>\n",
       "      <th>volume</th>\n",
       "      <th>turnover</th>\n",
       "      <th>change_rate</th>\n",
       "      <th>last_close</th>\n",
       "      <th>plate_id</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>code</th>\n",
       "      <th>plate_name</th>\n",
       "      <th>time_key</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">HK.BK1241</th>\n",
       "      <th rowspan=\"5\" valign=\"top\">石化股</th>\n",
       "      <th>2020-10-19 00:00:00</th>\n",
       "      <td>500.854</td>\n",
       "      <td>505.374</td>\n",
       "      <td>509.177</td>\n",
       "      <td>497.813</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>188895610</td>\n",
       "      <td>4.462303e+08</td>\n",
       "      <td>0.902459</td>\n",
       "      <td>500.935</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-10-20 00:00:00</th>\n",
       "      <td>500.749</td>\n",
       "      <td>494.218</td>\n",
       "      <td>500.749</td>\n",
       "      <td>492.632</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>133881936</td>\n",
       "      <td>3.570083e+08</td>\n",
       "      <td>-2.207474</td>\n",
       "      <td>505.374</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-10-21 00:00:00</th>\n",
       "      <td>498.866</td>\n",
       "      <td>495.767</td>\n",
       "      <td>499.281</td>\n",
       "      <td>494.066</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>77815861</td>\n",
       "      <td>2.055916e+08</td>\n",
       "      <td>0.313424</td>\n",
       "      <td>494.218</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-10-22 00:00:00</th>\n",
       "      <td>494.485</td>\n",
       "      <td>497.907</td>\n",
       "      <td>499.595</td>\n",
       "      <td>490.860</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>112185126</td>\n",
       "      <td>2.774813e+08</td>\n",
       "      <td>0.431654</td>\n",
       "      <td>495.767</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-10-23 00:00:00</th>\n",
       "      <td>502.693</td>\n",
       "      <td>537.201</td>\n",
       "      <td>537.201</td>\n",
       "      <td>499.443</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>272837327</td>\n",
       "      <td>7.676172e+08</td>\n",
       "      <td>7.891835</td>\n",
       "      <td>497.907</td>\n",
       "      <td>BK1241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">HK.BK1214</th>\n",
       "      <th rowspan=\"5\" valign=\"top\">电信股</th>\n",
       "      <th>2020-10-19 00:00:00</th>\n",
       "      <td>630.828</td>\n",
       "      <td>632.676</td>\n",
       "      <td>638.241</td>\n",
       "      <td>629.235</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>94889857</td>\n",
       "      <td>9.040565e+08</td>\n",
       "      <td>0.292948</td>\n",
       "      <td>633.495</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-10-20 00:00:00</th>\n",
       "      <td>630.379</td>\n",
       "      <td>631.830</td>\n",
       "      <td>634.899</td>\n",
       "      <td>629.233</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>151809311</td>\n",
       "      <td>1.130378e+09</td>\n",
       "      <td>-0.133718</td>\n",
       "      <td>632.676</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-10-21 00:00:00</th>\n",
       "      <td>635.501</td>\n",
       "      <td>664.024</td>\n",
       "      <td>671.202</td>\n",
       "      <td>634.101</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>312443390</td>\n",
       "      <td>3.094369e+09</td>\n",
       "      <td>5.095358</td>\n",
       "      <td>631.830</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-10-22 00:00:00</th>\n",
       "      <td>652.729</td>\n",
       "      <td>637.223</td>\n",
       "      <td>653.270</td>\n",
       "      <td>636.367</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>283284340</td>\n",
       "      <td>2.055431e+09</td>\n",
       "      <td>-4.036149</td>\n",
       "      <td>664.024</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-10-23 00:00:00</th>\n",
       "      <td>637.816</td>\n",
       "      <td>646.542</td>\n",
       "      <td>646.542</td>\n",
       "      <td>632.183</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>157432664</td>\n",
       "      <td>1.233921e+09</td>\n",
       "      <td>1.462439</td>\n",
       "      <td>637.223</td>\n",
       "      <td>BK1214</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                             open    close     high      low  \\\n",
       "code      plate_name time_key                                                  \n",
       "HK.BK1241 石化股        2020-10-19 00:00:00  500.854  505.374  509.177  497.813   \n",
       "                     2020-10-20 00:00:00  500.749  494.218  500.749  492.632   \n",
       "                     2020-10-21 00:00:00  498.866  495.767  499.281  494.066   \n",
       "                     2020-10-22 00:00:00  494.485  497.907  499.595  490.860   \n",
       "                     2020-10-23 00:00:00  502.693  537.201  537.201  499.443   \n",
       "...                                           ...      ...      ...      ...   \n",
       "HK.BK1214 电信股        2020-10-19 00:00:00  630.828  632.676  638.241  629.235   \n",
       "                     2020-10-20 00:00:00  630.379  631.830  634.899  629.233   \n",
       "                     2020-10-21 00:00:00  635.501  664.024  671.202  634.101   \n",
       "                     2020-10-22 00:00:00  652.729  637.223  653.270  636.367   \n",
       "                     2020-10-23 00:00:00  637.816  646.542  646.542  632.183   \n",
       "\n",
       "                                          pe_ratio  turnover_rate     volume  \\\n",
       "code      plate_name time_key                                                  \n",
       "HK.BK1241 石化股        2020-10-19 00:00:00       0.0            0.0  188895610   \n",
       "                     2020-10-20 00:00:00       0.0            0.0  133881936   \n",
       "                     2020-10-21 00:00:00       0.0            0.0   77815861   \n",
       "                     2020-10-22 00:00:00       0.0            0.0  112185126   \n",
       "                     2020-10-23 00:00:00       0.0            0.0  272837327   \n",
       "...                                            ...            ...        ...   \n",
       "HK.BK1214 电信股        2020-10-19 00:00:00       0.0            0.0   94889857   \n",
       "                     2020-10-20 00:00:00       0.0            0.0  151809311   \n",
       "                     2020-10-21 00:00:00       0.0            0.0  312443390   \n",
       "                     2020-10-22 00:00:00       0.0            0.0  283284340   \n",
       "                     2020-10-23 00:00:00       0.0            0.0  157432664   \n",
       "\n",
       "                                              turnover  change_rate  \\\n",
       "code      plate_name time_key                                         \n",
       "HK.BK1241 石化股        2020-10-19 00:00:00  4.462303e+08     0.902459   \n",
       "                     2020-10-20 00:00:00  3.570083e+08    -2.207474   \n",
       "                     2020-10-21 00:00:00  2.055916e+08     0.313424   \n",
       "                     2020-10-22 00:00:00  2.774813e+08     0.431654   \n",
       "                     2020-10-23 00:00:00  7.676172e+08     7.891835   \n",
       "...                                                ...          ...   \n",
       "HK.BK1214 电信股        2020-10-19 00:00:00  9.040565e+08     0.292948   \n",
       "                     2020-10-20 00:00:00  1.130378e+09    -0.133718   \n",
       "                     2020-10-21 00:00:00  3.094369e+09     5.095358   \n",
       "                     2020-10-22 00:00:00  2.055431e+09    -4.036149   \n",
       "                     2020-10-23 00:00:00  1.233921e+09     1.462439   \n",
       "\n",
       "                                          last_close plate_id  \n",
       "code      plate_name time_key                                  \n",
       "HK.BK1241 石化股        2020-10-19 00:00:00     500.935   BK1241  \n",
       "                     2020-10-20 00:00:00     505.374   BK1241  \n",
       "                     2020-10-21 00:00:00     494.218   BK1241  \n",
       "                     2020-10-22 00:00:00     495.767   BK1241  \n",
       "                     2020-10-23 00:00:00     497.907   BK1241  \n",
       "...                                              ...      ...  \n",
       "HK.BK1214 电信股        2020-10-19 00:00:00     633.495   BK1214  \n",
       "                     2020-10-20 00:00:00     632.676   BK1214  \n",
       "                     2020-10-21 00:00:00     631.830   BK1214  \n",
       "                     2020-10-22 00:00:00     664.024   BK1214  \n",
       "                     2020-10-23 00:00:00     637.223   BK1214  \n",
       "\n",
       "[100 rows x 11 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "new_table = new_table.unstack(-1).change_rate /100 + 1 \n",
    "#把時間變為Column, 香港板塊的代號﹐名字做Row﹐然後變change_rate格式轉換﹐方便使用cumprod"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time_key</th>\n",
       "      <th>2020-10-19 00:00:00</th>\n",
       "      <th>2020-10-20 00:00:00</th>\n",
       "      <th>2020-10-21 00:00:00</th>\n",
       "      <th>2020-10-22 00:00:00</th>\n",
       "      <th>2020-10-23 00:00:00</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>code</th>\n",
       "      <th>plate_name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>HK.BK1186</th>\n",
       "      <th>稀土概念</th>\n",
       "      <td>1.006410</td>\n",
       "      <td>0.982359</td>\n",
       "      <td>1.019642</td>\n",
       "      <td>0.986543</td>\n",
       "      <td>1.043087</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1187</th>\n",
       "      <th>人民币升值概念</th>\n",
       "      <td>1.017272</td>\n",
       "      <td>1.014003</td>\n",
       "      <td>1.017147</td>\n",
       "      <td>0.997843</td>\n",
       "      <td>1.020262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1196</th>\n",
       "      <th>汽车经销商</th>\n",
       "      <td>0.993507</td>\n",
       "      <td>1.057975</td>\n",
       "      <td>1.044326</td>\n",
       "      <td>0.982312</td>\n",
       "      <td>1.026696</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1200</th>\n",
       "      <th>核电</th>\n",
       "      <td>1.015838</td>\n",
       "      <td>0.978900</td>\n",
       "      <td>1.012469</td>\n",
       "      <td>0.988047</td>\n",
       "      <td>1.022025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1205</th>\n",
       "      <th>石油股</th>\n",
       "      <td>1.009041</td>\n",
       "      <td>0.984803</td>\n",
       "      <td>1.003128</td>\n",
       "      <td>0.992605</td>\n",
       "      <td>1.067889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1209</th>\n",
       "      <th>婴儿及小童用品股</th>\n",
       "      <td>0.988035</td>\n",
       "      <td>0.955952</td>\n",
       "      <td>0.991607</td>\n",
       "      <td>0.991090</td>\n",
       "      <td>1.017000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1210</th>\n",
       "      <th>百货业股</th>\n",
       "      <td>1.001088</td>\n",
       "      <td>1.004762</td>\n",
       "      <td>0.994493</td>\n",
       "      <td>1.004634</td>\n",
       "      <td>1.023504</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1213</th>\n",
       "      <th>港口运输股</th>\n",
       "      <td>0.981833</td>\n",
       "      <td>0.997643</td>\n",
       "      <td>1.014273</td>\n",
       "      <td>1.000393</td>\n",
       "      <td>1.027989</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1214</th>\n",
       "      <th>电信股</th>\n",
       "      <td>1.002929</td>\n",
       "      <td>0.998663</td>\n",
       "      <td>1.050954</td>\n",
       "      <td>0.959639</td>\n",
       "      <td>1.014624</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1224</th>\n",
       "      <th>电力设备股</th>\n",
       "      <td>0.977648</td>\n",
       "      <td>0.991808</td>\n",
       "      <td>0.990222</td>\n",
       "      <td>0.995485</td>\n",
       "      <td>1.041158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1225</th>\n",
       "      <th>连锁快餐店</th>\n",
       "      <td>0.994505</td>\n",
       "      <td>0.987950</td>\n",
       "      <td>1.002802</td>\n",
       "      <td>0.991737</td>\n",
       "      <td>1.026201</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1228</th>\n",
       "      <th>内险股</th>\n",
       "      <td>1.011598</td>\n",
       "      <td>1.002207</td>\n",
       "      <td>0.999601</td>\n",
       "      <td>0.999792</td>\n",
       "      <td>1.026603</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1233</th>\n",
       "      <th>光伏太阳能股</th>\n",
       "      <td>0.962690</td>\n",
       "      <td>1.048476</td>\n",
       "      <td>0.996125</td>\n",
       "      <td>0.963964</td>\n",
       "      <td>1.016387</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1237</th>\n",
       "      <th>风电股</th>\n",
       "      <td>1.015283</td>\n",
       "      <td>0.968964</td>\n",
       "      <td>0.988913</td>\n",
       "      <td>0.996846</td>\n",
       "      <td>1.035669</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1240</th>\n",
       "      <th>航空股</th>\n",
       "      <td>1.004211</td>\n",
       "      <td>1.002963</td>\n",
       "      <td>1.020645</td>\n",
       "      <td>0.994094</td>\n",
       "      <td>1.029404</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1241</th>\n",
       "      <th>石化股</th>\n",
       "      <td>1.009025</td>\n",
       "      <td>0.977925</td>\n",
       "      <td>1.003134</td>\n",
       "      <td>1.004317</td>\n",
       "      <td>1.078918</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1244</th>\n",
       "      <th>高铁基建股</th>\n",
       "      <td>1.009055</td>\n",
       "      <td>0.983060</td>\n",
       "      <td>1.005534</td>\n",
       "      <td>0.989205</td>\n",
       "      <td>1.037057</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1252</th>\n",
       "      <th>香港银行股</th>\n",
       "      <td>1.007009</td>\n",
       "      <td>0.997028</td>\n",
       "      <td>1.011606</td>\n",
       "      <td>1.001749</td>\n",
       "      <td>1.036653</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1267</th>\n",
       "      <th>烟草概念</th>\n",
       "      <td>0.947640</td>\n",
       "      <td>1.031643</td>\n",
       "      <td>0.975561</td>\n",
       "      <td>0.995932</td>\n",
       "      <td>1.015828</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1992</th>\n",
       "      <th>工业大麻</th>\n",
       "      <td>1.018925</td>\n",
       "      <td>0.975449</td>\n",
       "      <td>0.998403</td>\n",
       "      <td>1.000827</td>\n",
       "      <td>1.022495</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "time_key              2020-10-19 00:00:00  2020-10-20 00:00:00  \\\n",
       "code      plate_name                                             \n",
       "HK.BK1186 稀土概念                   1.006410             0.982359   \n",
       "HK.BK1187 人民币升值概念                1.017272             1.014003   \n",
       "HK.BK1196 汽车经销商                  0.993507             1.057975   \n",
       "HK.BK1200 核电                     1.015838             0.978900   \n",
       "HK.BK1205 石油股                    1.009041             0.984803   \n",
       "HK.BK1209 婴儿及小童用品股               0.988035             0.955952   \n",
       "HK.BK1210 百货业股                   1.001088             1.004762   \n",
       "HK.BK1213 港口运输股                  0.981833             0.997643   \n",
       "HK.BK1214 电信股                    1.002929             0.998663   \n",
       "HK.BK1224 电力设备股                  0.977648             0.991808   \n",
       "HK.BK1225 连锁快餐店                  0.994505             0.987950   \n",
       "HK.BK1228 内险股                    1.011598             1.002207   \n",
       "HK.BK1233 光伏太阳能股                 0.962690             1.048476   \n",
       "HK.BK1237 风电股                    1.015283             0.968964   \n",
       "HK.BK1240 航空股                    1.004211             1.002963   \n",
       "HK.BK1241 石化股                    1.009025             0.977925   \n",
       "HK.BK1244 高铁基建股                  1.009055             0.983060   \n",
       "HK.BK1252 香港银行股                  1.007009             0.997028   \n",
       "HK.BK1267 烟草概念                   0.947640             1.031643   \n",
       "HK.BK1992 工业大麻                   1.018925             0.975449   \n",
       "\n",
       "time_key              2020-10-21 00:00:00  2020-10-22 00:00:00  \\\n",
       "code      plate_name                                             \n",
       "HK.BK1186 稀土概念                   1.019642             0.986543   \n",
       "HK.BK1187 人民币升值概念                1.017147             0.997843   \n",
       "HK.BK1196 汽车经销商                  1.044326             0.982312   \n",
       "HK.BK1200 核电                     1.012469             0.988047   \n",
       "HK.BK1205 石油股                    1.003128             0.992605   \n",
       "HK.BK1209 婴儿及小童用品股               0.991607             0.991090   \n",
       "HK.BK1210 百货业股                   0.994493             1.004634   \n",
       "HK.BK1213 港口运输股                  1.014273             1.000393   \n",
       "HK.BK1214 电信股                    1.050954             0.959639   \n",
       "HK.BK1224 电力设备股                  0.990222             0.995485   \n",
       "HK.BK1225 连锁快餐店                  1.002802             0.991737   \n",
       "HK.BK1228 内险股                    0.999601             0.999792   \n",
       "HK.BK1233 光伏太阳能股                 0.996125             0.963964   \n",
       "HK.BK1237 风电股                    0.988913             0.996846   \n",
       "HK.BK1240 航空股                    1.020645             0.994094   \n",
       "HK.BK1241 石化股                    1.003134             1.004317   \n",
       "HK.BK1244 高铁基建股                  1.005534             0.989205   \n",
       "HK.BK1252 香港银行股                  1.011606             1.001749   \n",
       "HK.BK1267 烟草概念                   0.975561             0.995932   \n",
       "HK.BK1992 工业大麻                   0.998403             1.000827   \n",
       "\n",
       "time_key              2020-10-23 00:00:00  \n",
       "code      plate_name                       \n",
       "HK.BK1186 稀土概念                   1.043087  \n",
       "HK.BK1187 人民币升值概念                1.020262  \n",
       "HK.BK1196 汽车经销商                  1.026696  \n",
       "HK.BK1200 核电                     1.022025  \n",
       "HK.BK1205 石油股                    1.067889  \n",
       "HK.BK1209 婴儿及小童用品股               1.017000  \n",
       "HK.BK1210 百货业股                   1.023504  \n",
       "HK.BK1213 港口运输股                  1.027989  \n",
       "HK.BK1214 电信股                    1.014624  \n",
       "HK.BK1224 电力设备股                  1.041158  \n",
       "HK.BK1225 连锁快餐店                  1.026201  \n",
       "HK.BK1228 内险股                    1.026603  \n",
       "HK.BK1233 光伏太阳能股                 1.016387  \n",
       "HK.BK1237 风电股                    1.035669  \n",
       "HK.BK1240 航空股                    1.029404  \n",
       "HK.BK1241 石化股                    1.078918  \n",
       "HK.BK1244 高铁基建股                  1.037057  \n",
       "HK.BK1252 香港银行股                  1.036653  \n",
       "HK.BK1267 烟草概念                   1.015828  \n",
       "HK.BK1992 工业大麻                   1.022495  "
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time_key</th>\n",
       "      <th>2020-10-19 00:00:00</th>\n",
       "      <th>2020-10-20 00:00:00</th>\n",
       "      <th>2020-10-21 00:00:00</th>\n",
       "      <th>2020-10-22 00:00:00</th>\n",
       "      <th>2020-10-23 00:00:00</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>code</th>\n",
       "      <th>plate_name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>HK.BK1196</th>\n",
       "      <th>汽车经销商</th>\n",
       "      <td>0.993507</td>\n",
       "      <td>1.051106</td>\n",
       "      <td>1.097697</td>\n",
       "      <td>1.078282</td>\n",
       "      <td>1.107068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1241</th>\n",
       "      <th>石化股</th>\n",
       "      <td>1.009025</td>\n",
       "      <td>0.986751</td>\n",
       "      <td>0.989843</td>\n",
       "      <td>0.994116</td>\n",
       "      <td>1.072570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1187</th>\n",
       "      <th>人民币升值概念</th>\n",
       "      <td>1.017272</td>\n",
       "      <td>1.031517</td>\n",
       "      <td>1.049205</td>\n",
       "      <td>1.046941</td>\n",
       "      <td>1.068155</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1205</th>\n",
       "      <th>石油股</th>\n",
       "      <td>1.009041</td>\n",
       "      <td>0.993707</td>\n",
       "      <td>0.996815</td>\n",
       "      <td>0.989443</td>\n",
       "      <td>1.056615</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1252</th>\n",
       "      <th>香港银行股</th>\n",
       "      <td>1.007009</td>\n",
       "      <td>1.004017</td>\n",
       "      <td>1.015669</td>\n",
       "      <td>1.017446</td>\n",
       "      <td>1.054738</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1240</th>\n",
       "      <th>航空股</th>\n",
       "      <td>1.004211</td>\n",
       "      <td>1.007187</td>\n",
       "      <td>1.027980</td>\n",
       "      <td>1.021909</td>\n",
       "      <td>1.051957</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1228</th>\n",
       "      <th>内险股</th>\n",
       "      <td>1.011598</td>\n",
       "      <td>1.013831</td>\n",
       "      <td>1.013426</td>\n",
       "      <td>1.013216</td>\n",
       "      <td>1.040171</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1186</th>\n",
       "      <th>稀土概念</th>\n",
       "      <td>1.006410</td>\n",
       "      <td>0.988656</td>\n",
       "      <td>1.008075</td>\n",
       "      <td>0.994510</td>\n",
       "      <td>1.037360</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1210</th>\n",
       "      <th>百货业股</th>\n",
       "      <td>1.001088</td>\n",
       "      <td>1.005856</td>\n",
       "      <td>1.000316</td>\n",
       "      <td>1.004952</td>\n",
       "      <td>1.028572</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1214</th>\n",
       "      <th>电信股</th>\n",
       "      <td>1.002929</td>\n",
       "      <td>1.001588</td>\n",
       "      <td>1.052623</td>\n",
       "      <td>1.010137</td>\n",
       "      <td>1.024910</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1244</th>\n",
       "      <th>高铁基建股</th>\n",
       "      <td>1.009055</td>\n",
       "      <td>0.991961</td>\n",
       "      <td>0.997451</td>\n",
       "      <td>0.986684</td>\n",
       "      <td>1.023247</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1213</th>\n",
       "      <th>港口运输股</th>\n",
       "      <td>0.981833</td>\n",
       "      <td>0.979518</td>\n",
       "      <td>0.993499</td>\n",
       "      <td>0.993890</td>\n",
       "      <td>1.021708</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1200</th>\n",
       "      <th>核电</th>\n",
       "      <td>1.015838</td>\n",
       "      <td>0.994404</td>\n",
       "      <td>1.006803</td>\n",
       "      <td>0.994768</td>\n",
       "      <td>1.016678</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1992</th>\n",
       "      <th>工业大麻</th>\n",
       "      <td>1.018925</td>\n",
       "      <td>0.993910</td>\n",
       "      <td>0.992323</td>\n",
       "      <td>0.993144</td>\n",
       "      <td>1.015485</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1237</th>\n",
       "      <th>风电股</th>\n",
       "      <td>1.015283</td>\n",
       "      <td>0.983772</td>\n",
       "      <td>0.972865</td>\n",
       "      <td>0.969797</td>\n",
       "      <td>1.004389</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1225</th>\n",
       "      <th>连锁快餐店</th>\n",
       "      <td>0.994505</td>\n",
       "      <td>0.982521</td>\n",
       "      <td>0.985275</td>\n",
       "      <td>0.977133</td>\n",
       "      <td>1.002735</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1224</th>\n",
       "      <th>电力设备股</th>\n",
       "      <td>0.977648</td>\n",
       "      <td>0.969639</td>\n",
       "      <td>0.960158</td>\n",
       "      <td>0.955823</td>\n",
       "      <td>0.995162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1233</th>\n",
       "      <th>光伏太阳能股</th>\n",
       "      <td>0.962690</td>\n",
       "      <td>1.009358</td>\n",
       "      <td>1.005447</td>\n",
       "      <td>0.969214</td>\n",
       "      <td>0.985097</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1267</th>\n",
       "      <th>烟草概念</th>\n",
       "      <td>0.947640</td>\n",
       "      <td>0.977626</td>\n",
       "      <td>0.953734</td>\n",
       "      <td>0.949854</td>\n",
       "      <td>0.964888</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HK.BK1209</th>\n",
       "      <th>婴儿及小童用品股</th>\n",
       "      <td>0.988035</td>\n",
       "      <td>0.944514</td>\n",
       "      <td>0.936587</td>\n",
       "      <td>0.928242</td>\n",
       "      <td>0.944022</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "time_key              2020-10-19 00:00:00  2020-10-20 00:00:00  \\\n",
       "code      plate_name                                             \n",
       "HK.BK1196 汽车经销商                  0.993507             1.051106   \n",
       "HK.BK1241 石化股                    1.009025             0.986751   \n",
       "HK.BK1187 人民币升值概念                1.017272             1.031517   \n",
       "HK.BK1205 石油股                    1.009041             0.993707   \n",
       "HK.BK1252 香港银行股                  1.007009             1.004017   \n",
       "HK.BK1240 航空股                    1.004211             1.007187   \n",
       "HK.BK1228 内险股                    1.011598             1.013831   \n",
       "HK.BK1186 稀土概念                   1.006410             0.988656   \n",
       "HK.BK1210 百货业股                   1.001088             1.005856   \n",
       "HK.BK1214 电信股                    1.002929             1.001588   \n",
       "HK.BK1244 高铁基建股                  1.009055             0.991961   \n",
       "HK.BK1213 港口运输股                  0.981833             0.979518   \n",
       "HK.BK1200 核电                     1.015838             0.994404   \n",
       "HK.BK1992 工业大麻                   1.018925             0.993910   \n",
       "HK.BK1237 风电股                    1.015283             0.983772   \n",
       "HK.BK1225 连锁快餐店                  0.994505             0.982521   \n",
       "HK.BK1224 电力设备股                  0.977648             0.969639   \n",
       "HK.BK1233 光伏太阳能股                 0.962690             1.009358   \n",
       "HK.BK1267 烟草概念                   0.947640             0.977626   \n",
       "HK.BK1209 婴儿及小童用品股               0.988035             0.944514   \n",
       "\n",
       "time_key              2020-10-21 00:00:00  2020-10-22 00:00:00  \\\n",
       "code      plate_name                                             \n",
       "HK.BK1196 汽车经销商                  1.097697             1.078282   \n",
       "HK.BK1241 石化股                    0.989843             0.994116   \n",
       "HK.BK1187 人民币升值概念                1.049205             1.046941   \n",
       "HK.BK1205 石油股                    0.996815             0.989443   \n",
       "HK.BK1252 香港银行股                  1.015669             1.017446   \n",
       "HK.BK1240 航空股                    1.027980             1.021909   \n",
       "HK.BK1228 内险股                    1.013426             1.013216   \n",
       "HK.BK1186 稀土概念                   1.008075             0.994510   \n",
       "HK.BK1210 百货业股                   1.000316             1.004952   \n",
       "HK.BK1214 电信股                    1.052623             1.010137   \n",
       "HK.BK1244 高铁基建股                  0.997451             0.986684   \n",
       "HK.BK1213 港口运输股                  0.993499             0.993890   \n",
       "HK.BK1200 核电                     1.006803             0.994768   \n",
       "HK.BK1992 工业大麻                   0.992323             0.993144   \n",
       "HK.BK1237 风电股                    0.972865             0.969797   \n",
       "HK.BK1225 连锁快餐店                  0.985275             0.977133   \n",
       "HK.BK1224 电力设备股                  0.960158             0.955823   \n",
       "HK.BK1233 光伏太阳能股                 1.005447             0.969214   \n",
       "HK.BK1267 烟草概念                   0.953734             0.949854   \n",
       "HK.BK1209 婴儿及小童用品股               0.936587             0.928242   \n",
       "\n",
       "time_key              2020-10-23 00:00:00  \n",
       "code      plate_name                       \n",
       "HK.BK1196 汽车经销商                  1.107068  \n",
       "HK.BK1241 石化股                    1.072570  \n",
       "HK.BK1187 人民币升值概念                1.068155  \n",
       "HK.BK1205 石油股                    1.056615  \n",
       "HK.BK1252 香港银行股                  1.054738  \n",
       "HK.BK1240 航空股                    1.051957  \n",
       "HK.BK1228 内险股                    1.040171  \n",
       "HK.BK1186 稀土概念                   1.037360  \n",
       "HK.BK1210 百货业股                   1.028572  \n",
       "HK.BK1214 电信股                    1.024910  \n",
       "HK.BK1244 高铁基建股                  1.023247  \n",
       "HK.BK1213 港口运输股                  1.021708  \n",
       "HK.BK1200 核电                     1.016678  \n",
       "HK.BK1992 工业大麻                   1.015485  \n",
       "HK.BK1237 风电股                    1.004389  \n",
       "HK.BK1225 连锁快餐店                  1.002735  \n",
       "HK.BK1224 电力设备股                  0.995162  \n",
       "HK.BK1233 光伏太阳能股                 0.985097  \n",
       "HK.BK1267 烟草概念                   0.964888  \n",
       "HK.BK1209 婴儿及小童用品股               0.944022  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_table.cumprod(axis=1).sort_values(by='2020-10-23 00:00:00', ascending=False) #以23/10日星期五計算，整星期升幅最多的香港板塊"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
